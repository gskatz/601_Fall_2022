{
  "hash": "b9a80126b63a533c543ee7737d9f4bd2",
  "result": {
    "markdown": "---\ntitle: \"HW2\"\nauthor: \"Lai Wei\"\ndesription: \"gain experience with working with external data, dplyr, and the pipe operator.\"\ndate: \"11/17/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw2\n  - Lai Wei\n\n---\n\n\nIn this HW, I will use mmr_2015.csv, which is a data set that contains a subset of the (real) data that were used to generate the United Nations Maternal mortality estimates, as published in the year 2015. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(babynames)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(babynames): there is no package called 'babynames'\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Read Data\n\nBackground for  mmr_2015.csv: \nThe maternal mortality ratio (MMR) is defined as the number of maternal deaths per 100,000 live births. The UN maternal mortality estimation group produces estimates of the MMR for all countries in the world.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmmr <- read.csv(\"_data/mmr_2015.csv\")\nmmr\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    iso                    country year      mmr\n1   AFG                Afghanistan 2000 1900.000\n2   DZA                    Algeria 1999  117.410\n3   BGD                 Bangladesh 2009  194.000\n4   BGD                 Bangladesh 2000  322.156\n5   BWA                   Botswana 2006  139.790\n6   BWA                   Botswana 2012  147.900\n7   BWA                   Botswana 2005  157.700\n8   BWA                   Botswana 2010  163.000\n9   BWA                   Botswana 2013  182.600\n10  BWA                   Botswana 2007  183.470\n11  BWA                   Botswana 2011  188.860\n12  BWA                   Botswana 2009  189.570\n13  BWA                   Botswana 2008  195.730\n14  CMR                   Cameroon 2010  652.000\n15  CHN                      China 2012   24.500\n16  CHN                      China 2011   26.100\n17  CHN                      China 2010   30.000\n18  CHN                      China 2009   31.900\n19  CHN                      China 2008   34.200\n20  CHN                      China 2007   36.600\n21  CHN                      China 2006   41.100\n22  CHN                      China 2002   43.200\n23  CHN                      China 2005   47.700\n24  CHN                      China 2004   48.300\n25  CHN                      China 2001   50.200\n26  CHN                      China 2003   51.300\n27  CHN                      China 2000   53.000\n28  CHN                      China 1999   58.700\n29  CHN                      China 1995   61.900\n30  CHN                      China 1997   63.600\n31  CHN                      China 1990   88.900\n32  EGY                      Egypt 2006   59.000\n33  EGY                      Egypt 2004   68.000\n34  EGY                      Egypt 2000   84.000\n35  EGY                      Egypt 1992  174.000\n36  SLV                El Salvador 2008   51.090\n37  SLV                El Salvador 2007   56.930\n38  HND                   Honduras 2012   74.100\n39  HND                   Honduras 2013   86.000\n40  IND                      India 2012  167.000\n41  IND                      India 2011  178.000\n42  IND                      India 2008  212.000\n43  IND                      India 2005  254.000\n44  IND                      India 2002  301.000\n45  IND                      India 2000  327.000\n46  IND                      India 1998  398.000\n47  IND                      India 1992  437.000\n48  IND                      India 1999  540.000\n49  IRN Iran (Islamic Republic of) 2013   19.700\n50  IRN Iran (Islamic Republic of) 2012   19.900\n51  IRN Iran (Islamic Republic of) 2008   20.900\n52  IRN Iran (Islamic Republic of) 2011   21.500\n53  IRN Iran (Islamic Republic of) 2006   21.700\n54  IRN Iran (Islamic Republic of) 2010   22.100\n55  IRN Iran (Islamic Republic of) 2005   23.800\n56  IRN Iran (Islamic Republic of) 2004   24.100\n57  IRN Iran (Islamic Republic of) 2007   24.700\n58  IRN Iran (Islamic Republic of) 2009   25.400\n59  IRN Iran (Islamic Republic of) 2002   27.400\n60  IRN Iran (Islamic Republic of) 2003   28.300\n61  IRQ                       Iraq 2012   35.000\n62  JAM                    Jamaica 2009   73.200\n63  JAM                    Jamaica 1999   73.500\n64  JAM                    Jamaica 1995   81.300\n65  JAM                    Jamaica 2012   81.300\n66  JAM                    Jamaica 2004   82.500\n67  JAM                    Jamaica 2003   89.800\n68  JAM                    Jamaica 1998   90.100\n69  JAM                    Jamaica 2000   90.300\n70  JAM                    Jamaica 2001   91.500\n71  JAM                    Jamaica 2007   92.900\n72  JAM                    Jamaica 2011   95.700\n73  JAM                    Jamaica 2006   96.700\n74  JAM                    Jamaica 2008  102.000\n75  JAM                    Jamaica 2005  109.200\n76  JAM                    Jamaica 2002  110.500\n77  JAM                    Jamaica 2010  113.300\n78  MNG                   Mongolia 2014   30.200\n79  MNG                   Mongolia 2013   42.600\n80  MNG                   Mongolia 2010   47.400\n81  MNG                   Mongolia 2008   48.600\n82  MNG                   Mongolia 2011   48.700\n83  MNG                   Mongolia 2012   51.500\n84  MNG                   Mongolia 2006   67.200\n85  MNG                   Mongolia 2009   81.000\n86  MNG                   Mongolia 2007   88.300\n87  MNG                   Mongolia 2005   92.700\n88  MNG                   Mongolia 2004   96.700\n89  MNG                   Mongolia 2003  107.200\n90  MNG                   Mongolia 2002  121.500\n91  MNG                   Mongolia 1997  143.500\n92  MNG                   Mongolia 1998  162.400\n93  MNG                   Mongolia 2001  165.000\n94  MNG                   Mongolia 2000  166.200\n95  MNG                   Mongolia 1996  173.700\n96  MNG                   Mongolia 1999  182.000\n97  MNG                   Mongolia 1995  186.000\n98  MNG                   Mongolia 1992  203.900\n99  MNG                   Mongolia 1994  219.000\n100 MNG                   Mongolia 1993  259.000\n101 MMR                    Myanmar 2004  315.860\n102 NPL                      Nepal 2008  229.000\n103 OMN                       Oman 1993    6.000\n104 OMN                       Oman 1997   13.300\n105 OMN                       Oman 1999   13.700\n106 OMN                       Oman 2005   15.400\n107 OMN                       Oman 1992   15.900\n108 OMN                       Oman 2000   16.100\n109 OMN                       Oman 1998   18.500\n110 OMN                       Oman 2004   18.500\n111 OMN                       Oman 1996   21.000\n112 OMN                       Oman 1995   22.000\n113 OMN                       Oman 2001   23.100\n114 OMN                       Oman 2003   23.200\n115 OMN                       Oman 1994   24.400\n116 OMN                       Oman 1991   27.400\n117 OMN                       Oman 2002   37.500\n118 PRY                   Paraguay 2001  178.000\n119 PER                       Peru 2011   92.700\n120 PER                       Peru 2010   95.900\n121 PER                       Peru 2009   96.100\n122 PER                       Peru 2008  107.900\n123 PER                       Peru 2007  110.500\n124 PER                       Peru 2005  114.100\n125 PER                       Peru 2006  114.900\n126 PER                       Peru 2002  118.300\n127 PER                       Peru 2004  120.800\n128 PER                       Peru 2003  123.800\n129 SAU               Saudi Arabia 1997   23.000\n130 SSD                South Sudan 2005 2037.000\n131 LKA                  Sri Lanka 2010   31.100\n132 LKA                  Sri Lanka 2011   32.500\n133 LKA                  Sri Lanka 2008   33.400\n134 LKA                  Sri Lanka 2012   37.700\n135 LKA                  Sri Lanka 2004   38.000\n136 LKA                  Sri Lanka 2007   38.400\n137 LKA                  Sri Lanka 2006   39.300\n138 LKA                  Sri Lanka 2009   40.200\n139 LKA                  Sri Lanka 2003   42.400\n140 LKA                  Sri Lanka 2005   44.000\n141 LKA                  Sri Lanka 2001   46.600\n142 LKA                  Sri Lanka 1998   53.000\n143 LKA                  Sri Lanka 2002   53.400\n144 LKA                  Sri Lanka 2000   55.600\n145 LKA                  Sri Lanka 1999   55.800\n146 LKA                  Sri Lanka 1995   61.000\n147 LKA                  Sri Lanka 1996   62.000\n148 LKA                  Sri Lanka 1997   63.000\n149 SDN                      Sudan 2009  215.600\n150 SDN                      Sudan 2005  638.000\n151 SYR       Syrian Arab Republic 2008   56.000\n152 THA                   Thailand 1998   36.400\n153 THA                   Thailand 1997   36.500\n154 THA                   Thailand 2005   37.400\n155 THA                   Thailand 2006   41.600\n156 THA                   Thailand 1996   44.100\n157 THA                   Thailand 2004   44.500\n158 TUN                    Tunisia 2008   44.800\n159 TUN                    Tunisia 1993   68.900\n160 TUR                     Turkey 2014   15.200\n161 TUR                     Turkey 2012   15.400\n162 TUR                     Turkey 2011   15.500\n163 TUR                     Turkey 2013   15.900\n164 TUR                     Turkey 2010   16.400\n165 TUR                     Turkey 2009   18.400\n166 TUR                     Turkey 2008   19.400\n167 TUR                     Turkey 2007   21.200\n168 ARE       United Arab Emirates 2005    0.000\n169 ARE       United Arab Emirates 2000    0.000\n170 ARE       United Arab Emirates 2008    1.400\n171 ARE       United Arab Emirates 1995   22.400\n172 ARE       United Arab Emirates 1990   32.600\n173 VNM                   Viet Nam 2009   69.000\n174 VNM                   Viet Nam 2001  130.000\n175 YEM                      Yemen 2012  148.160\n```\n:::\n:::\n\nVariables in the data set mmr_2015.csv are as follows:\n\n-\tIso = ISO code\n-\tName = country name\n-\tYear = observation year\n-\tMMR = observed maternal mortality ratio, which is defined as the number of maternal deaths/total number of births*100,000\n\n## Data Visualization\n\nConstruct a graph that shows the observed values of the MMR plotted against year (starting in 2000) for China and Viet Nam.Use the pipe operator so that the graph follows from a multi-line command that starts with “mmr %>%”.Use ggplot() to display the data.\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_IT <- filter(mmr,country == \"China\"|country == \"Viet Nam\",year >= 2000)\nggplot(data = data_IT,aes(x = year,y= mmr))+\n  geom_point(aes(group = country,color = country))\n```\n\n::: {.cell-output-display}\n![](HW2_Lai-Wei_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## Babynames\n\nBabynames package is the Names of male and female babies born in the US from 1880 to 2017.Babynames was filtered to include only those rows with year > 1975, sex equal to male, and either prop > 0.025 or n > 50000.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbabynames %>% \n  filter(year > 1975, sex == \"M\",prop > 0.025|n > 50000) %>% \n  ggplot(aes(x = year, y = prop))+\n  geom_point(aes(group = name,color = name), size = 2)+\n  geom_line(aes(group = name, color = name))+\n  expand_limits(y = 0)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., year > 1975, sex == \"M\", prop > 0.025 | n > 50000): object 'babynames' not found\n```\n:::\n:::\n\n\n## Tidy Table\n\nConstruct and print a tibble that shows the countries sorted by their average observed MMR (rounded to zero digits), with the country with the highest average MMR listed first.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1<- group_by(mmr,country) %>% \n  summarise_at(vars(mmr),list(name = mean))\n  names(data1)[2] = \"ave\" \n  data1$ave <- round(data1$ave,0)\n  arrange(data1,desc(ave))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 30 × 2\n   country       ave\n   <chr>       <dbl>\n 1 South Sudan  2037\n 2 Afghanistan  1900\n 3 Cameroon      652\n 4 Sudan         427\n 5 Myanmar       316\n 6 India         313\n 7 Bangladesh    258\n 8 Nepal         229\n 9 Paraguay      178\n10 Botswana      172\n# … with 20 more rows\n```\n:::\n:::\n\n\n##Continuing with the mmr data set\n\nPart a: For each year\n- first calculate the mean observed value for each country. \n- then rank countries by increasing MMR for each year. \n\nCalculate the mean ranking across all years, extract the mean ranking for 10 countries with the lowest ranking across all years, and print the resulting table. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2<-\n  mmr %>% \n  group_by(year) %>% \n  mutate(Mean = mean(mmr,na.rm = TRUE)) %>% \n  arrange(desc(mmr))\ndata2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 175 × 5\n# Groups:   year [25]\n   iso   country      year   mmr  Mean\n   <chr> <chr>       <int> <dbl> <dbl>\n 1 SSD   South Sudan  2005 2037  275. \n 2 AFG   Afghanistan  2000 1900  301. \n 3 CMR   Cameroon     2010  652  130. \n 4 SDN   Sudan        2005  638  275. \n 5 IND   India        1999  540  149. \n 6 IND   India        1992  437  208. \n 7 IND   India        1998  398  126. \n 8 IND   India        2000  327  301. \n 9 BGD   Bangladesh   2000  322. 301. \n10 MMR   Myanmar      2004  316.  85.7\n# … with 165 more rows\n```\n:::\n\n```{.r .cell-code}\n  arrange(data2,desc(Mean)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 175 × 5\n# Groups:   year [25]\n   iso   country               year    mmr  Mean\n   <chr> <chr>                <int>  <dbl> <dbl>\n 1 AFG   Afghanistan           2000 1900    301.\n 2 IND   India                 2000  327    301.\n 3 BGD   Bangladesh            2000  322.   301.\n 4 MNG   Mongolia              2000  166.   301.\n 5 JAM   Jamaica               2000   90.3  301.\n 6 EGY   Egypt                 2000   84    301.\n 7 LKA   Sri Lanka             2000   55.6  301.\n 8 CHN   China                 2000   53    301.\n 9 OMN   Oman                  2000   16.1  301.\n10 ARE   United Arab Emirates  2000    0    301.\n# … with 165 more rows\n```\n:::\n\n```{.r .cell-code}\nlowest10 <- print(tail(data2,10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 5\n# Groups:   year [9]\n   iso   country               year   mmr  Mean\n   <chr> <chr>                <int> <dbl> <dbl>\n 1 TUR   Turkey                2011  15.5  77.7\n 2 OMN   Oman                  2005  15.4 275. \n 3 TUR   Turkey                2012  15.4  73.0\n 4 TUR   Turkey                2014  15.2  22.7\n 5 OMN   Oman                  1999  13.7 149. \n 6 OMN   Oman                  1997  13.3  57.2\n 7 OMN   Oman                  1993   6   111. \n 8 ARE   United Arab Emirates  2008   1.4  82.6\n 9 ARE   United Arab Emirates  2005   0   275. \n10 ARE   United Arab Emirates  2000   0   301. \n```\n:::\n:::\n\n\nPart b: With rankings calculated separately for two periods, with period 1 referring to years < 2000 and period 2 referring to years >= 2000. \n\nFor each period\n\n- first calculate the mean observed value for each country \n- then rank countries by increasing MMR for each period. \n\nCalculate the mean ranking across all periods, extract the 10 countries with the lowest ranking across all periods, and print the table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbefore_2000<-mmr %>% \n  filter(year < 2000) %>% \n  group_by(country) %>% \n  mutate(Mean = mean(mmr,na.rm = TRUE)) %>% \n  arrange(desc(mmr))\nbefore_2000\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 41 × 5\n# Groups:   country [12]\n   iso   country   year   mmr  Mean\n   <chr> <chr>    <int> <dbl> <dbl>\n 1 IND   India     1999  540   458.\n 2 IND   India     1992  437   458.\n 3 IND   India     1998  398   458.\n 4 MNG   Mongolia  1993  259   191.\n 5 MNG   Mongolia  1994  219   191.\n 6 MNG   Mongolia  1992  204.  191.\n 7 MNG   Mongolia  1995  186   191.\n 8 MNG   Mongolia  1999  182   191.\n 9 EGY   Egypt     1992  174   174 \n10 MNG   Mongolia  1996  174.  191.\n# … with 31 more rows\n```\n:::\n\n```{.r .cell-code}\n  print(tail(before_2000,10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 5\n# Groups:   country [3]\n   iso   country               year   mmr  Mean\n   <chr> <chr>                <int> <dbl> <dbl>\n 1 OMN   Oman                  1994  24.4  18.0\n 2 SAU   Saudi Arabia          1997  23    23  \n 3 ARE   United Arab Emirates  1995  22.4  27.5\n 4 OMN   Oman                  1995  22    18.0\n 5 OMN   Oman                  1996  21    18.0\n 6 OMN   Oman                  1998  18.5  18.0\n 7 OMN   Oman                  1992  15.9  18.0\n 8 OMN   Oman                  1999  13.7  18.0\n 9 OMN   Oman                  1997  13.3  18.0\n10 OMN   Oman                  1993   6    18.0\n```\n:::\n\n```{.r .cell-code}\nafter_2000 <- mmr %>% \n  filter(year >= 2000) %>% \n  group_by(country) %>% \n  mutate(Mean = mean(mmr,na.rm = TRUE)) %>% \n  arrange(desc(mmr))\nafter_2000\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 134 × 5\n# Groups:   country [28]\n   iso   country      year   mmr  Mean\n   <chr> <chr>       <int> <dbl> <dbl>\n 1 SSD   South Sudan  2005 2037  2037 \n 2 AFG   Afghanistan  2000 1900  1900 \n 3 CMR   Cameroon     2010  652   652 \n 4 SDN   Sudan        2005  638   427.\n 5 IND   India        2000  327   240.\n 6 BGD   Bangladesh   2000  322.  258.\n 7 MMR   Myanmar      2004  316.  316.\n 8 IND   India        2002  301   240.\n 9 IND   India        2005  254   240.\n10 NPL   Nepal        2008  229   229 \n# … with 124 more rows\n```\n:::\n\n```{.r .cell-code}\n  print(tail(after_2000,10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 5\n# Groups:   country [3]\n   iso   country               year   mmr   Mean\n   <chr> <chr>                <int> <dbl>  <dbl>\n 1 TUR   Turkey                2010  16.4 17.2  \n 2 OMN   Oman                  2000  16.1 22.3  \n 3 TUR   Turkey                2013  15.9 17.2  \n 4 TUR   Turkey                2011  15.5 17.2  \n 5 OMN   Oman                  2005  15.4 22.3  \n 6 TUR   Turkey                2012  15.4 17.2  \n 7 TUR   Turkey                2014  15.2 17.2  \n 8 ARE   United Arab Emirates  2008   1.4  0.467\n 9 ARE   United Arab Emirates  2005   0    0.467\n10 ARE   United Arab Emirates  2000   0    0.467\n```\n:::\n:::",
    "supporting": [
      "HW2_Lai-Wei_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}