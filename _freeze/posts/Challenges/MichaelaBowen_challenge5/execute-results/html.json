{
  "hash": "f2c6857b3bc96031d080cdbcebff9d1d",
  "result": {
    "markdown": "---\ntitle: \"Challenge 5\"\nauthor: \"Michaela Bowen\"\ndescription: \"Introduction to Visualization\"\ndate: \"10/19/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_5\n  - Work Data\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(lubridate)\nlibrary(scales)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nIn today's Challenge I've attempted to:\n\n1)  read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  mutate variables as needed (including sanity checks)\n4)  create at least two univariate visualizations\n5)  Create at least one bivariate visualization\n\n\n::: {.panel-tabset}\n## Read in and tidy data\n\nBelow I have ready in a two week transaction period of cannabis sales at the local dispensary. \n\nOn the Read in I have: \n\n- Renamed several variables to \"delete\" as they will not be used in our analysis and thus ignored:\n+ `Product Sku`: Not necessary because it is replicated with the product name which carries more information \n+ `BioTrackId`, `BioTrack Response`, `RxNum`: These are all categories unused by the business, and do not contain useful information\n+ `Remaining  Qty`: Does not contain *any* accurate information\n\n\n### Inventory Transactions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Read in Excel Data\ntransactions_9_22_2022_10_20_2022_orig <- read_excel(\"Inventory Transactions 9_22_2022-10_20_2022.xlsx\", \n    skip = 5,\n    col_names = c(\"pos_id\",\"product\",\"delete\",\"patient_name\",\"transaction_date\",\"qty_sold\",\"daily_allottment_oz\",\"weight_grams\",\"cost\",\"price\",\"owner_name\",\"owner_location\",\"vendor\",\"sold_by\",\"receipt_no\",\"delete\",\"delete\",\"delete\",\"delete\",\"delete\"))%>%\n  select(!contains(\"delete\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: `path` does not exist: 'Inventory Transactions 9_22_2022-10_20_2022.xlsx'\n```\n:::\n:::\n\n\n\n## Briefly describe the data\nThe transactions data frame we are working with consists of the completed sales transaction at Resinate, Northampton Spanning from 9/22/2022 through 10/05/2022. There are 5,591 instances of 13 variables, meaning that nearly 5,600 transactions were completed during this time period. The variables describe the product type, category, date, patient name, receipt number, budtender, and other transaction information. \n\n\n### Column Mutations\nHere I am mutating several variables:\n\n- `date`: I am separating out this date column into hour, minute, and second in order to pin point time of day in which customers are ordering certain products\n- `category`, `category_names`: I created these two variables from the 3 letter abbreviation at the beginning of the product name\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#mutating date field and formatting as a date\ntransactions_9_22_2022_10_20_2022 <- transactions_9_22_2022_10_20_2022_orig%>%\n  mutate(\n    date = as.Date(transaction_date),\n    hour = hour(transaction_date),\n    minute = minute(transaction_date),\n    second = second(transaction_date))%>%\n  mutate(\n    format_date = format(date, \"%m/%d/%Y\"),\n    format_hour = paste(hour, minute, second, sep = \":\")\n  )%>%\n#pulling the category abbreviation to determine category and create a category column\n  mutate(\n    category = substr(product,1,3)\n  )%>%\n  mutate(\n    category_names = case_when(\n      category == \"FLO\" | category == \"Flo\" ~ \"Flower\",\n      category == \"PRJ\" ~ \"Joint\",\n      category == \"EDI\" ~ \"Edible\",\n      category == \"MIP\" ~ \"Marijuana Infused Product\",\n      category == \"CON\" | category == \"Con\" ~ \"Concentrate\",\n      category == \"VAP\" | category == \"Vap\" ~ \"Vaporizer\",\n      category == \"ACC\" | category == \"Pax\" | category == \"PAX\" | category == \"Hig\" | category == \"Bov\" ~ \"Accessories\",\n      category == \"CLO\" | category == \"Res\" ~ \"Clothing\",\n      category == \"HTC\" ~ \"HTCC Promotion\",\n      category == \"SAM\" ~ \"Samples\",\n      category == \"TOP\" ~ \"Topical\",\n      category == \"REW\" ~ \"Rewards\")\n  )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., date = as.Date(transaction_date), hour = hour(transaction_date), : object 'transactions_9_22_2022_10_20_2022_orig' not found\n```\n:::\n:::\n\n\n### Tidy Data (Sanity Checks)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#ensuring that the category, and category names columns contain no NA values and are accurately coded\nunique(transactions_9_22_2022_10_20_2022$category_names)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in unique(transactions_9_22_2022_10_20_2022$category_names): object 'transactions_9_22_2022_10_20_2022' not found\n```\n:::\n\n```{.r .cell-code}\nunique(transactions_9_22_2022_10_20_2022$category)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in unique(transactions_9_22_2022_10_20_2022$category): object 'transactions_9_22_2022_10_20_2022' not found\n```\n:::\n:::\n\n\n### Data Summary\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(summarytools::dfSummary(transactions_9_22_2022_10_20_2022,\n                        varnumbers = FALSE,\n                        plain.ascii  = FALSE, \n                        style        = \"grid\", \n                        graph.magnif = 0.70, \n                        valid.col    = FALSE),\n      method = 'render',\n      table.classes = 'table-condensed')\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summarytools::dfSummary(transactions_9_22_2022_10_20_2022, varnumbers = FALSE, : object 'transactions_9_22_2022_10_20_2022' not found\n```\n:::\n:::\n\n\n\n## Univariate Visualizations\nIn this farily simple univariate visualization, we can see the number of sales by category. It is clear that Joints are the most popular category followed by Edibles and Flower. This is to be expected in a dispensary as Joints and Edibles are some of the most convenient ways to consume cannabis, followed by Flower that can be ground up and used however the customer pleases.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#univariate visualization of the categories\nggplot(data = transactions_9_22_2022_10_20_2022, mapping = aes(category_names, fill = category_names), size = 1) +\n  geom_bar() +\n  ylim(0, NA) +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +\n  ylab(\"Number\") +\n  xlab(\"Categories\")+\n  ggtitle(\"Sale Number by Category\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(data = transactions_9_22_2022_10_20_2022, mapping = aes(category_names, : object 'transactions_9_22_2022_10_20_2022' not found\n```\n:::\n:::\n\n\n## Bivariate Visualization(s)\nIn our first Bivariate visualization we can see the volume of sales by category over time with a violin graph. The volume graph gives a visual representation of popularity of category over time. This can tell us popularity trends, or interest trends by category as well.\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = transactions_9_22_2022_10_20_2022, mapping = aes(x = date, y = category_names), size = 1) +\n  geom_violin() +\n  theme(legend.title=element_blank(),axis.text.x = element_text(angle = 90, vjust = 0.5)) +\n  ylab(\"Cannabis Categories\") +\n  scale_x_date(date_labels=\"%b %d\", breaks = unique(transactions_9_22_2022_10_20_2022$date)) +\n  ggtitle(\"Categorical Volume Sales by date\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(data = transactions_9_22_2022_10_20_2022, mapping = aes(x = date, : object 'transactions_9_22_2022_10_20_2022' not found\n```\n:::\n:::\n\nIn this second Bivariate Visualization I chose a scatterplot to compare the Average price by product to the quantity sold. I was able to gain the following inside:\n\n- Most products are priced between $0 and $90 \n- Within a two week period we are selling approximately 50 units of our most popular products within that price range\n- We can also see that Joints are the most popular category, with nearly 300 units sold within the given time period. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#creating a flower transactions dataframe\nsold_by_price <- transactions_9_22_2022_10_20_2022%>%\n  group_by(product)%>%\n  mutate(avg_price = mean(price),\n         products_sold = sum(qty_sold))%>%\n  select(-qty_sold)%>%\n  distinct()%>%\n  ggplot(aes(x = avg_price, y = products_sold, color = category_names)) +\n  ylim(0,NA) +\n  scale_x_continuous(breaks = c(0,30,60,90,120,150,180,210,240,270,300)) +\n  geom_point(size = 1)+\n  labs(title =  \"Quantity of Products sold by Average Price\")+\n  xlab(\"Average Price\") +\n  ylab(\"Quantity Sold\") +\n  theme(legend.title=element_blank(),axis.text.x = element_text(angle = 45, vjust = 0.5) )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., product): object 'transactions_9_22_2022_10_20_2022' not found\n```\n:::\n\n```{.r .cell-code}\nsold_by_price \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'sold_by_price' not found\n```\n:::\n:::\n\n\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}