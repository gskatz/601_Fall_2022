{
  "hash": "ce750b726c519f59b6c1229db6bda666",
  "result": {
    "markdown": "---\ntitle: \"Challenge 8 Solutions\"\nauthor: \"Vishnupriya Varadharaju\"\ndescription: \"Joining Data\"\ndate: \"12/10/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_8\n  - snl\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nWorking with the SNL Dataset for this Challenge.\n\n## Read in data\n\nThe SNL data set consists of three different csv files. They are read into separate dataframes.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reading in the SNL dataset\nactors <- read_csv(\"_data/snl_actors.csv\", show_col_types = FALSE)\ncasts <- read_csv(\"_data/snl_casts.csv\", show_col_types = FALSE)\nseasons<- read_csv(\"_data/snl_seasons.csv\", show_col_types = FALSE)\n\nhead(actors)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n  aid            url           type  gender \n  <chr>          <chr>         <chr> <chr>  \n1 Kate McKinnon  /Cast/?KaMc   cast  female \n2 Alex Moffat    /Cast/?AlMo   cast  male   \n3 Ego Nwodim     /Cast/?EgNw   cast  unknown\n4 Chris Redd     /Cast/?ChRe   cast  male   \n5 Kenan Thompson /Cast/?KeTh   cast  male   \n6 Carey Mulligan /Guests/?3677 guest andy   \n```\n:::\n\n```{.r .cell-code}\nhead(casts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 8\n  aid                sid featured first_epid last_epid update_…¹ n_epi…² seaso…³\n  <chr>            <dbl> <lgl>         <dbl>     <dbl> <lgl>       <dbl>   <dbl>\n1 A. Whitney Brown    11 TRUE       19860222        NA FALSE           8   0.444\n2 A. Whitney Brown    12 TRUE             NA        NA FALSE          20   1    \n3 A. Whitney Brown    13 TRUE             NA        NA FALSE          13   1    \n4 A. Whitney Brown    14 TRUE             NA        NA FALSE          20   1    \n5 A. Whitney Brown    15 TRUE             NA        NA FALSE          20   1    \n6 A. Whitney Brown    16 TRUE             NA        NA FALSE          20   1    \n# … with abbreviated variable names ¹​update_anchor, ²​n_episodes,\n#   ³​season_fraction\n```\n:::\n\n```{.r .cell-code}\nhead(seasons)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n    sid  year first_epid last_epid n_episodes\n  <dbl> <dbl>      <dbl>     <dbl>      <dbl>\n1     1  1975   19751011  19760731         24\n2     2  1976   19760918  19770521         22\n3     3  1977   19770924  19780520         20\n4     4  1978   19781007  19790526         20\n5     5  1979   19791013  19800524         20\n6     6  1980   19801115  19810411         13\n```\n:::\n:::\n\n\n\n### Briefly describe the data\n\nThere are three datasets. The first one is actors, which has 4 fields and 2306 observations. It basically consists of details about each actor, the type and their gender. The second dataset is casts which has 8 fields and 614 observations. Each row corresponds to a season that a particular actor has featured in. It also has details about the number of episodes that actor has featured in that particular season. The third dataset is seasons which consists of 5 fields and 46 observations. Each row corresponds to a season, the year it was released, the number of episodes in that season and the first and last episode dates.\n\n## Tidy Data (as needed)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Actors\n# Find the different types and genders\n\nunique(actors$type)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"cast\"    \"guest\"   \"crew\"    \"unknown\"\n```\n:::\n\n```{.r .cell-code}\nunique(actors$gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"female\"  \"male\"    \"unknown\" \"andy\"   \n```\n:::\n\n```{.r .cell-code}\nactors <- actors %>% select(-c(url))\nactors\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,306 × 3\n   aid            type  gender \n   <chr>          <chr> <chr>  \n 1 Kate McKinnon  cast  female \n 2 Alex Moffat    cast  male   \n 3 Ego Nwodim     cast  unknown\n 4 Chris Redd     cast  male   \n 5 Kenan Thompson cast  male   \n 6 Carey Mulligan guest andy   \n 7 Marcus Mumford guest male   \n 8 Aidy Bryant    cast  female \n 9 Steve Higgins  crew  male   \n10 Mikey Day      cast  male   \n# … with 2,296 more rows\n```\n:::\n:::\n\nWe can see that in actors, there is a particular type called 'unknown'. In gender we can also see 'unknown' and another field called 'andy'. We can retain these for now and remove them later if needed. We can remove the url field as it seems redundant for our analysis here.\n\nThe other two datasets seem to have the data in place. We can rename a few of these columns for better readability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Renaming columns in actors\nactors <- actors %>% \n  rename(\n    Actor = aid,\n    Type = type,\n    Gender = gender\n    )\n\n# Renaming columns in casts\ncasts <- casts %>%\n  rename(\n    Actor = aid,\n    Season = sid,\n    Featured = featured,\n    Anchor = update_anchor,\n    Episodes = n_episodes,\n    EpisodesProp = season_fraction\n  )\n\n# Renaming columns in seasons\nseasons <- seasons %>%\n  rename(\n    Season = sid,\n    Year = year,\n    FirstEpisode = first_epid,\n    LastEpisode = last_epid,\n    TotEpisodes = n_episodes,\n  )\n```\n:::\n\n\nThere are some fields in these datasets which can be mutated. The 'andy' field under Gender in actors can also be mutated to 'unknown'.\n\n::: {.cell}\n\n```{.r .cell-code}\nactors <- actors %>%\n  mutate(Gender = str_replace(Gender, \"andy\", \"unknown\"), Type = str_replace(Type, \"unknown\", \"celebrity\")\n  )\n```\n:::\n\n\n\n## Join Data\n\nWe can now join the actors and casts data so that we can get an indicator of the gender and typeof all the actors being featured in different seasons. Here I am doing a left join wherein for each row in the casts table, I want the respective fields from actors table to be merged.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactorsCasts = merge(x=casts,y=actors,by=\"Actor\",all.x=TRUE)\n```\n:::\n\n\nNext, I would also like to merge the seasons table to this, to get the Year and the total number of episodes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnl = merge(x=actorsCasts, y=seasons, by=\"Season\", all.x=TRUE)\n```\n:::\n\n\nNow we have a single table with all of the SNL data. From this table, I can now drop some redundant columns like 'EpisodesProp', 'FirstEpisode', 'LastEpisode' as these details can be inferred from the other fields.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnl <- snl %>% select(-c(EpisodesProp,FirstEpisode,LastEpisode)) %>% filter(Featured == FALSE)\n```\n:::\n\n\nFrom this table, we can further calculate the number of female, male and unknowns who have taken part from 2010-2020 and not featured.\n\n::: {.cell}\n\n```{.r .cell-code}\ngenCount <- snl %>% select(c(Season, Actor, Gender, Year)) %>% \n  filter(Year > 2010) %>%\n  group_by(Season, Gender) %>%\n  summarise(count = n())\ngenCount\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 21 × 3\n# Groups:   Season [10]\n   Season Gender count\n    <dbl> <chr>  <int>\n 1     37 female     3\n 2     37 male       7\n 3     38 female     2\n 4     38 male       8\n 5     39 female     5\n 6     39 male       5\n 7     40 female     4\n 8     40 male       4\n 9     41 female     5\n10     41 male       7\n# … with 11 more rows\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}