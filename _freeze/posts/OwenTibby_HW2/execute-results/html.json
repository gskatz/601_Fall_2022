{
  "hash": "18bcd613dbad659accf27d0a154fca09",
  "result": {
    "markdown": "---\ntitle: \"Homework 2\"\nauthor: \"Owen Tibby\"\ndesription: \"Homework 2\"\ndate: \"11/07/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - HW2\n  - Car Prices\n  - Owen Tibby\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidyr)\nlibrary(summarytools)\nlibrary(dplyr)\nlibrary(readr)\nlibrary(stringr)\nlibrary(lubridate)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n::: panel-tabset\n## Instructions\n\nFor this homework, your goal is to read in a more complicated dataset. Please use the category tag \"hw2\" as well as a tag for the dataset you choose to use.\n\nRead in a dataset from the _data folder in the course blog repository, or choose your own data. If you decide to use one of the datasets we have provided, please use a challenging dataset - check with us if you are not sure.Â \n\nClean the data as needed using dplyr and related tidyverse packages.\n\nProvide a narrative about the data set (look it up if you aren't sure what you have got) and the variables in your dataset, including what type of data each variable is. The goal of this step is to communicate in a visually appealing way to non-experts - not to replicate r-code.\n\nIdentify potential research questions that your dataset can help answer.\n\nWhen you click the Render button a document will be generated that includes both content and the output of embedded code.\n:::\n\n## \n\n::: panel-tabset\n## Reading in the Data\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#RStudio Desktop\ncarprices <- read_csv(\"~/Github/car_prices.csv\", col_types = cols(vin = col_skip(), mmr = col_number(), sellingprice = col_number(), ...17 = col_skip()))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: '~/Github/car_prices.csv' does not exist.\n```\n:::\n\n```{.r .cell-code}\n#RStudio Cloud\n# carprices <- read_csv(\"car_prices.csv\",\n#     col_types = cols(vin = col_skip(), mmr = col_number(), sellingprice = col_number(), ...17 = col_skip()))\n```\n:::\n\n\n::: panel-tabset\n## Brief Description of the data\n\nThis data set contains historical used vehicle auction prices that took place between 1982 and 2015.\n\nFirst, lets take a look at the variables in the data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#dfSummary(carprices)\n```\n:::\n\n:::\n\n::: panel-tabset\n## Cleaning the Data\n\nRemoving NA values from make and model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Observing the amount of NAs in our most important variables\n# carprices %>% \n#   filter(is.na(model), is.na(make)) %>% \n#   dim()\n\ncarprices <- carprices %>% \n  filter(!is.na(make), !is.na(model), !is.na(odometer), !is.na(mmr)) \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., !is.na(make), !is.na(model), !is.na(odometer), !is.na(mmr)): object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n  #dfSummary(carprices)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#carprices <- na.omit(carprices, `mmr`, `condition`)\n```\n:::\n\n\nI notice that there are 76 distinct values for body. I'll explore and condense them into fewer categories in a new column called \"Body_type\" below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncarprices %>% \n  select(body) %>% \n distinct() %>% print()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., body): object 'carprices' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Creating a Body Type column\ncarprices <- mutate(carprices, Body_Type = case_when(str_detect(body, \"edan\")~ \"Sedan\", str_detect(body, \"SUV\") ~ \"SUV\", str_detect(body, \"ab\") ~ \"Pickup\", str_detect(body, \"oup\")~ \"Coupe\", str_detect(`body`, \"Van\")~ \"Minivan\", str_detect(`body`,\"onv\")~ \"Convertible\", str_detect(`body`,\"ago\") ~ \"Wagon\", str_detect(`body`,\"atch\")~ \"Hatchback\", str_detect(`body`,\"crew\")~ \"Pickup\" ))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(carprices, Body_Type = case_when(str_detect(body, \"edan\") ~ : object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n# print(carprices)\n```\n:::\n\n\nI'll create a new variable called Launch_date. Since most vehicles of model year x are released in the fall of the the previous year, I'll follow that logic and assume that for all makes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Creating Launch Date Step 1\n\ncarprices<- carprices %>% \n  mutate(launch_month= \"9\", launch_day= \"1\", launch_year= (`year`-1))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., launch_month = \"9\", launch_day = \"1\", launch_year = (year - : object 'carprices' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Creating Launch Date Step 2\ncarprices <- carprices %>% \nmutate(launch_date= make_date(year= `launch_year`, month = `launch_month`, day=`launch_day`))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., launch_date = make_date(year = launch_year, month = launch_month, : object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n# print(carprices)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Converting saledate to a date variable\ncarprices <- carprices %>% \n  separate(saledate, into= c(\"ddd\", \"sale_month\", \"sale_day\", \"sale_year\", \"sale_time\", \"GMT\", \"TMZ\"), sep=\" \") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in separate(., saledate, into = c(\"ddd\", \"sale_month\", \"sale_day\", : object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n#print(carprices)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Recoding the format of the sale month\ncarprices <- mutate(carprices, sale_month2= recode(sale_month, `Jan` =\"1\", `Feb`= \"2\", `Mar`=\"3\", `Apr`=\"4\", `May`=\"5\", `Jun`=\"6\", `Jul`=\"7\", `Aug`=\"8\", `Sep`=\"9\", `Oct`=\"10\", `Nov`=\"11\", `Dec`=\"12\" ))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(carprices, sale_month2 = recode(sale_month, Jan = \"1\", : object 'carprices' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Creating Date_Sold\ncarprices <- mutate(carprices, Date_Sold = make_date(year=sale_year, month = sale_month2, day = sale_day))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(carprices, Date_Sold = make_date(year = sale_year, month = sale_month2, : object 'carprices' not found\n```\n:::\n:::\n\n\nTidying up what I have so far:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Selecting useful columns\n \ncarprices <- carprices %>% \nselect(year, make, model, trim, transmission, Body_Type, state, condition, odometer, color, interior, seller, mmr, sellingprice, launch_date, Date_Sold ) \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., year, make, model, trim, transmission, Body_Type, state, : object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n#print(carprices)\n```\n:::\n\n\nCalculating the age of the vehicle at the time of sale:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Age of vehicle\n\ncarprices <- mutate(carprices, Vehicle_Age_Months= round(as.numeric(difftime(Date_Sold, launch_date, units= \"days\"))/30))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(carprices, Vehicle_Age_Months = round(as.numeric(difftime(Date_Sold, : object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\nprint(carprices)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in print(carprices): object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n#Checking for negatives in Vehicle Age\ncarprices %>% \n  # select(Vehicle_Age_Months) %>% \n  filter(Vehicle_Age_Months<0) %>% \n  count()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., Vehicle_Age_Months < 0): object 'carprices' not found\n```\n:::\n\n```{.r .cell-code}\n#Recoding Vehicle Age\ncarprices<-carprices %>% \n  mutate(Vehicle_Age_Months=recode(Vehicle_Age_Months, `-8`=0))%>% \n  print()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., Vehicle_Age_Months = recode(Vehicle_Age_Months, `-8` = 0)): object 'carprices' not found\n```\n:::\n:::\n\n\nI'm curious to see if we can get MSRP by looking at mileage and vehicle age and using the MMR. I'll explore below:\n\n::: {.cell}\n\n```{.r .cell-code}\n#Exploring if we can get MSRP \ncarprices %>% \n  group_by(`make`) %>% \n  filter(Vehicle_Age_Months<3, odometer<1000) %>% \n  arrange(`make`, `model`) %>% \n  print()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., make): object 'carprices' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncarprices %>% \n  select(state) %>% \n  distinct() %>% \n  print()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., state): object 'carprices' not found\n```\n:::\n:::\n\n:::\n\n::: panel-tabset\n## Narrative about the data set..\n\nThis data set contains historical used vehicle auction prices that took place between 1982 and 2015. The data was collected from all Manheim auction houses across the 38 states in the USA. Each observation details a wholesale auction trasaction that includes: the vehicle information, state, selling price and the market average price i.e the Manheim Market Report price (MMR) and other specifics about the sale. \n\n\n\n\n\n:::\n\n::: panel-tabset\n## Potential Research Questions\n\n1.  What is the average selling price varies by state?\n2.  What is the correlation between condition and selling price?\n3.  Is there a correlation between MMR vs Selling price?\n4.  How age of transaction varies by state? To do this, I need to create a column for launch date.\n5.  How does mileage affect vehicle sale price?\n6.  Is there a correlation between mileage and condition?\n7.  What are the average miles driven in each state?\n8.  How does condition vary mileage vary with age?\n9.  Controlling vehicle condition, how does mileage vary with age?\n10. Selling price by body type?\n:::\n\n## \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}