{
  "hash": "fc639b88660da0832077bbaae7136fc0",
  "result": {
    "markdown": "---\ntitle: \"HW3\"\nauthor: \"Prajakti Kapade\"\ndescription: \"Homework 3\"\ndate: \"12/03/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.2\n```\n:::\n:::\n\n\n#Read Dataset\nWe will load the hotel_bookings dataset.\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data <- read_csv('_data/hotel_bookings.csv')\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in read_csv(\"_data/hotel_bookings.csv\"): could not find function \"read_csv\"\n```\n:::\n\n```{.r .cell-code}\nhotel_data\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(hotel_data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(x): object 'hotel_data' not found\n```\n:::\n:::\n\n\nThe dataset contains 32 columns and 119,390 observations. The columns are shown above. \nSome of the categorical columns are : hotel, deposit_type, company, customer_type\nThe columns related to time are : \"lead_time\" ,\"arrival_date_year\" , \"arrival_date_month\"     \"arrival_date_week_number\" ,\"arrival_date_day_of_month\" ,\"stays_in_weekend_nights\", \"stays_in_week_nights\"\nThe target column according to this dataset is : \"is_cancelled\" which is binary 1 for YES and 0 for NO.\n\n#Dataset Statistics\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(hotel_data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(hotel_data): object 'hotel_data' not found\n```\n:::\n:::\n\nSummary provides the statistics for each column.As, we can see this dataset is well-defined in terms of rows and columns, thus, they need no pivoting.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(hotel_data$hotel)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in unique(hotel_data$hotel): object 'hotel_data' not found\n```\n:::\n\n```{.r .cell-code}\nunique(hotel_data$deposit_type)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in unique(hotel_data$deposit_type): object 'hotel_data' not found\n```\n:::\n\n```{.r .cell-code}\nunique(hotel_data$customer_type)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in unique(hotel_data$customer_type): object 'hotel_data' not found\n```\n:::\n:::\n\nThere are two types of hotels : \"Resort Hotel\", \"City Hotel\", three types of Deposits : \"No Deposit\" ,\"Refundable\" ,\"Non Refund\", and four types of customers in this dataset : \"Transient\",\"Contract\",\"Transient-Party\",\"Group\".\n\nWe will look at the frequency for categorical columns.\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  group_by(customer_type)%>%\n  summarise(num=n())%>%\n  arrange(desc(num))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., customer_type): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  group_by(market_segment)%>%\n  summarise(num=n())%>%\n  arrange(desc(num))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., market_segment): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  group_by(hotel)%>%\n  summarise(num=n())%>%\n  arrange(desc(num))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., hotel): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  group_by(distribution_channel)%>%\n  summarise(num=n())%>%\n  arrange(desc(num))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., distribution_channel): object 'hotel_data' not found\n```\n:::\n:::\n\n\n#Dataset Cleaning\nUsing the code below to see the null values\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(hotel_data, function(x) sum(is.na(x)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in lapply(X = X, FUN = FUN, ...): object 'hotel_data' not found\n```\n:::\n:::\n\n\nAs, we just have null values in one column i.e. Children. We can substitue those 4 values with the values in babies columns, as they mean the same or are giving same context.\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- length(hotel_data$children)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'hotel_data' not found\n```\n:::\n\n```{.r .cell-code}\nfor (i in 1:n) {\n  if (is.na(hotel_data$children[i]))\n    hotel_data$children[i] <- hotel_data$babies[i]\n}\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in 1:n: NA/NaN argument\n```\n:::\n:::\n\n\nNow, we will look at one column which does not clearly define itself : \"adr\". It should be \"average daily rate\". According to the summary, the maximum value is very high while the mean lies in 100s. We will look at how many records are actually in the high range.\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  filter(adr>2000)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., adr > 2000): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  filter(adr>1000)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., adr > 1000): object 'hotel_data' not found\n```\n:::\n:::\n\nWe can see, there is only one record which can be an outlier, so we can replace the value by mean of the column \"adr\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data = hotel_data%>%\n  mutate(adr = replace(adr, adr>1000, mean(adr)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., adr = replace(adr, adr > 1000, mean(adr))): object 'hotel_data' not found\n```\n:::\n:::\n\n\n#Data Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = hotel_data, aes(x = hotel)) +\n  geom_bar(stat = \"count\",fill='lightblue') +\n  labs(title = \"Booking by Hotel type\",\n       x = \"Hotel type\",\n       y = \"No. of bookings\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(data = hotel_data, aes(x = hotel)): object 'hotel_data' not found\n```\n:::\n:::\n\nThe visualization shows that City Hotels have higher booking than Resorts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = hotel_data, aes(x = customer_type)) +\n  geom_bar(stat = \"count\",fill='purple') +\n  labs(title = \"Booking by customer type\",\n       x = \"Customer type\",\n       y = \"No. of bookings\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(data = hotel_data, aes(x = customer_type)): object 'hotel_data' not found\n```\n:::\n:::\n\nThe visualization suggests that the Customers having maximum bookings are Transient, followed by Transient-Party, then Contract and lastly Groups.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = hotel_data, aes(x = market_segment)) +\n  geom_bar(stat = \"count\",fill='lightblue') +\n  labs(title = \"Booking by Market Segment\",\n       x = \"Market Segment\",\n       y = \"No. of bookings\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(data = hotel_data, aes(x = market_segment)): object 'hotel_data' not found\n```\n:::\n:::\n\nThe visualization suggests that the Market Segment with highest booking is Online TA, while the ones with least bookings are in Aviation Segment ( If we ignore Undefined)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = hotel_data, aes(x = distribution_channel)) +\n  geom_bar(stat = \"count\",fill='purple') +\n  labs(title = \"Booking by Distribution channel\",\n       x = \"Distribution channel\",\n       y = \"No. of bookings\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(data = hotel_data, aes(x = distribution_channel)): object 'hotel_data' not found\n```\n:::\n:::\n\nThe visualization suggests that the Distribution channel with maximum bookings is TA/TO while the one with least bookings is GDS.\n\n#Visualizations\n\nBelow are visualizing deposit type, customer type and market segment for each Hotel type.\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot distribution of deposit type\nhotel_data %>% select(hotel, deposit_type) %>% \n                group_by( hotel, deposit_type) %>% \n                summarise(n = n()) %>% \n                ggplot(aes(reorder(deposit_type, n), n, fill = hotel)) + \n                geom_bar(stat = \"identity\", position = position_dodge()) + xlab(\"\") + \n                ylab(\"# of bookings\") + labs(fill = \"Hotel type\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., hotel, deposit_type): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot distribution of deposit type\nhotel_data %>% select(hotel, customer_type) %>% \n                group_by( hotel, customer_type) %>% \n                summarise(n = n()) %>% \n                ggplot(aes(reorder(customer_type, n), n, fill = hotel)) + \n                geom_bar(stat = \"identity\", position = position_dodge()) + xlab(\"\") + \n                ylab(\"# of bookings\") + labs(fill = \"Hotel type\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., hotel, customer_type): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot distribution of deposit type\nhotel_data %>% select(hotel, market_segment) %>% \n                group_by( hotel, market_segment) %>% \n                summarise(n = n()) %>% \n                ggplot(aes(reorder(market_segment, n), n, fill = hotel)) + \n                geom_bar(stat = \"identity\", position = position_dodge()) + xlab(\"\") + \n                ylab(\"# of bookings\") + labs(fill = \"Hotel type\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., hotel, market_segment): object 'hotel_data' not found\n```\n:::\n:::\n\nBelow are the visualizations related to our Target Variable \"is_cancelled\" ( 1 for YES and 0 for NO)\nThese visualizations show the distribution of cancelled bookings per hotel type and customer type.\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot distribution of deposit type\nhotel_data %>% select(is_canceled, hotel) %>% \n                group_by( is_canceled, hotel) %>% \n                summarise(n = n()) %>% \n                ggplot(aes(reorder(hotel, n), n, fill = is_canceled)) + \n                geom_bar(stat = \"identity\", position = position_dodge()) + xlab(\"\") + \n                ylab(\"# of bookings\") + labs(fill = \"Hotel type\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., is_canceled, hotel): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot distribution of deposit type\nhotel_data %>% select(is_canceled, customer_type) %>% \n                group_by( is_canceled, customer_type) %>% \n                summarise(n = n()) %>% \n                ggplot(aes(reorder(customer_type, n), n, fill = is_canceled)) + \n                geom_bar(stat = \"identity\", position = position_dodge()) + xlab(\"\") + \n                ylab(\"# of bookings\") + labs(fill = \"Hotel type\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., is_canceled, customer_type): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot distribution of deposit type\nhotel_data %>% select(is_canceled, is_repeated_guest) %>% \n                group_by( is_canceled, is_repeated_guest) %>% \n                summarise(n = n()) %>% \n                ggplot(aes(reorder(is_repeated_guest, n), n, fill = is_canceled)) + \n                geom_bar(stat = \"identity\", position = position_dodge()) + xlab(\"\") + \n                ylab(\"# of bookings\") + labs(fill = \"Hotel type\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., is_canceled, is_repeated_guest): object 'hotel_data' not found\n```\n:::\n:::\n\n\nWe can summarize the following from the plots above:\n1. The number of bookings for Resorts are half the number of bookings for the City Hotels.\n2. Majority of the City Hotels have No Deposit for the booking, while there are 0 City Hotels asking for Refundable Deposits.\n3. Majority of customers booking the City Hotels are Transient, followed by Transient-Party.\n4. Most cancellations were made for City Hotels.\n5. Most cancellations were made by Transient Customers.\n6. Repeated guests have very low percentage of cancellations.\n\n\nNow, we will look at the distribution of hotels per country\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data%>%\n  group_by(country)%>%\n  summarise(num=n())%>%\n  arrange(desc(num))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in group_by(., country): object 'hotel_data' not found\n```\n:::\n:::\n\n\nAs, \"is_canceled\" is our target variable, let us see the cancelations per country.\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data %>% \n  select(country, is_canceled) %>% \n  group_by(country) %>% \n  summarise_if(is.numeric, sum, na.rm = TRUE) %>% \n  arrange(desc(is_canceled)) %>% \n  head(n=10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., country, is_canceled): object 'hotel_data' not found\n```\n:::\n:::\n\n\nThe maximum bookings are made in : PRT,GBR,FRA,ESP,DEU\nThe maximum cancelations are made in : PRT,GBR,ESP,FRA,ITA\n\nAs seen, FRA has higher bookings than ESP, and the cancelations are less as compared the ESP. Thus, the hit rate i.e. the probability for booking to happen is high in FRA.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data %>% \n  select(country, stays_in_week_nights) %>% \n  group_by(country) %>% \n  summarise_if(is.numeric, mean, na.rm = TRUE) %>% \n  arrange(desc(stays_in_week_nights)) %>% \n  head(n=10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., country, stays_in_week_nights): object 'hotel_data' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhotel_data %>% \n  select(country, stays_in_weekend_nights) %>% \n  group_by(country) %>% \n  summarise_if(is.numeric, mean, na.rm = TRUE) %>% \n  arrange(desc(stays_in_weekend_nights)) %>% \n  head(n=10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., country, stays_in_weekend_nights): object 'hotel_data' not found\n```\n:::\n:::\n\nAlso, we can see the stay in week nights and weekend nights follow almost similar pattern in terms of the countries, with FRO and SEN being the top 2.\n\nThe visualizations fail to answer:\n- The difference between Resort and City Hotels?\n- How does arrival date/month/year affect the bookings and the cancellations?\n- How is the \"adr\" field affecting the bookings? Do they depict something?\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}