{
  "hash": "91842434a56acf2e99da329415faa42a",
  "result": {
    "markdown": "---\ntitle: \"Challenge 7\"\nauthor: \"Michaela Bowen\"\ndescription: \"Visualizing Multiple Dimensions\"\ndate: \"11/07/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_7\n  - Transaction Data\neditor: \n  markdown: \n    wrap: 72\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(lubridate)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n::: panel-tabset\n# Read in data\n\nBelow I have read in the inventory transaction data. There will be more\ndetail about that data set to follow. On the read in, I have eliminated\nunnecessary columns, as well as observations that are not relevant to\nour findings.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntransactions_sept_oct_orig <- read_excel(\"Inventory Transactions 9_1_2022-11_3_2022.xlsx\",\n    skip = 5,\n    col_names = c(\"pos_id\",\"product\",\"delete\",\"patient_name\",\"transaction_date\",\"qty_sold\",\"daily_allottment_oz\",\"weight_grams\",\"cost\",\"price\",\"owner_name\",\"owner_location\",\"vendor\",\"sold_by\",\"receipt_no\",\"delete\",\"delete\",\"delete\",\"delete\",\"delete\"))%>%\n  filter(sold_by != \"Michaela Bowen\")%>%\n  select(!contains(\"delete\"))\n```\n:::\n\n\n# Briefly describe the data\n\nThe transactions data frame we are working with consist of the completed\nsales transactions at Resinate, Northampton Spanning from 09/01/2022\nthrough 11/03/2022. There are 25,880 instances of 14 variables, meaning\nthat nearly 26,000 items were sold during this time period, between\nnearly 7,700 transactions. Each instance is a product sold, rather than\na complete transaction. All products were sold by 8 employees during\nthis time. The variables describe the product type, category, date,\npatient name, receipt number, budtender, and other transaction\ninformation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#number of products sold\nnrow(transactions_sept_oct_orig)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 25883\n```\n:::\n\n```{.r .cell-code}\n#number of transactions\nn_distinct(transactions_sept_oct_orig$receipt_no)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7734\n```\n:::\n\n```{.r .cell-code}\n#number of employees\nn_distinct(transactions_sept_oct_orig$sold_by)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n\n```{.r .cell-code}\n#number of customers\nn_distinct(transactions_sept_oct_orig$patient_name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5121\n```\n:::\n:::\n\n\n## Tidy Data\n\nMutated Columns:\n\n-   `date`: I am separating out this date column into hour, minute, and\n    second in order to pin point time of day in which customers are\n    ordering certain products.\n\n-   `category`, `category_names`: I created these two variables from the\n    3 letter abbreviation at the beginning of the product name. This\n    will aid in isolating specific categories of product rather than\n\n-   `tier`: I am planning to create an ordinal column that has the\n    Flower Tier Specification. A,B,C, and D describe the percentage of\n    Total Active Canabinoids in each and thus determine their price.\n\n-   `FirstName`, `LastName`: I also separated the first and last name of\n    the Budtender so that I could only include first names in the\n    visualization\n\n-   `house_product`: Boolean which states whether a product is 3rd Party\n    or not\n\n-   `isCannabis`: Boolean which states whether a product is cannabis or\n    non-cannabis\n\n-   `weekdayLabel`: Day of the Week\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntransactions_sept_oct_working <- transactions_sept_oct_orig%>%\n#separating date, month, year, minute and second (thinking about removing second option, as it may not be useful)  \n  mutate(\n    date = as.Date(transaction_date),\n    day = day(transaction_date),\n    hour = hour(transaction_date),\n    minute = minute(transaction_date),\n    second = second(transaction_date))%>%\n  mutate(\n    format_date = format(date, \"%m/%d/%Y\"),\n    format_hour = paste(hour, minute, second, sep = \":\")\n  )%>%\n#pulling the category abbreviation to determine category and create a category column \n  mutate(\n    category = substr(product,1,3)\n  )%>%\n#changing the abbreviations into full category names\n  mutate(\n    category_names = case_when(\n      category == \"FLO\" | category == \"Flo\" ~ \"Flower\",\n      category == \"PRJ\" & weight_grams == 0.5 ~ \"Joint 0.5g\",\n      category == \"PRJ\" & weight_grams == 1 ~ \"Joint 1g\",\n      category == \"PRJ\" & weight_grams == 2.5 ~ \"Joint 0.5g 5pk\",\n      category == \"PRJ\" ~ \"Other Joint\",\n      category == \"EDI\" ~ \"Edible\",\n      category == \"CON\" | category == \"Con\" | category == \"MIP\" ~ \"Concentrate\",\n      category == \"VAP\" | category == \"Vap\" ~ \"Vaporizer\",\n      category == \"ACC\" | category == \"Pax\" | category == \"PAX\" | category == \"Hig\" | category == \"Bov\" ~ \"Accessories\",\n      category == \"CLO\" | category == \"Res\" ~ \"Clothing\",\n      category == \"HTC\" ~ \"ignore\",\n      category == \"SAM\" ~ \"ignore\",\n      category == \"TOP\" ~ \"Topical\",\n      category == \"REW\" ~ \"ignore\")\n  )%>%\n#created a logical variable to determine if flower was in house, or 3rd party\n  mutate(\n    house_product = if_else((vendor == \"Resinate, Inc.\"), \"Resinate\", \"3rd Party\", \"NA\")\n)%>%\n  mutate(\n   flower_tier = case_when(\n     category_names == \"Flower\" & (price == 48 | price == 50) ~ \"A Tier\",\n     category_names == \"Flower\" & price == 45 ~ \"B Tier\",\n     category_names == \"Flower\" & price == 40 ~ \"C Tier\",\n     category_names == \"Flower\" & (price == 30 | price == 35) ~ \"D Tier\"\n   ) \n  )%>%\n#created an isCannabis boolean column to separate accessories from cannabis product\n  mutate(\n    isCannabis = case_when(\n      (category_names == \"Flower\" | category_names == \"Joint 0.5g\" | category_names == \"Joint 1g\"| category_names == \"Other Joint\" | category_names == \"Joint 0.5g 5pk\"|  category_names == \"Edible\" | category_names == \"Concentrate\" | category_names == \"Vaporizer\" | category_names == \"Topical\") ~ TRUE,\n      (category_names == \"Accessories\" | category_names == \"ignore\" | category_names == \"Clothing\") ~ FALSE\n    ))%>%\n#separating the first and last names of the budtenders for anonymity purposes\n  extract(sold_by, c(\"FirstName\", \"LastName\"), \"([^ ]+) (.*)\")%>%\n#day of the week label\n  mutate(weekdayLabel = wday(date, label = TRUE))\n\n\n#ensuring that the category, and category names columns contain no NA values and are accurately coded\nunique(transactions_sept_oct_working$category_names)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Joint 0.5g\"     \"Flower\"         \"Joint 1g\"       \"Concentrate\"   \n [5] \"Edible\"         \"Vaporizer\"      \"Joint 0.5g 5pk\" \"Accessories\"   \n [9] \"Topical\"        \"Other Joint\"    \"ignore\"         \"Clothing\"      \n```\n:::\n\n```{.r .cell-code}\nunique(transactions_sept_oct_working$category)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"PRJ\" \"FLO\" \"MIP\" \"CON\" \"EDI\" \"VAP\" \"Hig\" \"TOP\" \"Bov\" \"ACC\" \"Pax\" \"SAM\"\n[13] \"Res\" \"PAX\" \"HTC\" \"CLO\" \"REW\"\n```\n:::\n:::\n\n\n# Visualization with Multiple Dimensions\n\nBelow is the total items sold by Average price and category. It is\nfurther divided into 3rd Party and House product.\n\n## Simple Multi-Dimension Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsold_by_price <- transactions_sept_oct_working%>%\n  group_by(product)%>%\n  filter(isCannabis == TRUE)%>%\n  mutate(avg_price = mean(price),\n         products_sold = sum(qty_sold))%>%\n  select(-qty_sold)%>%\n  distinct()%>%\n  ggplot(aes(x = avg_price, y = products_sold, color = category_names)) +\n  ylim(0,NA) +\n  geom_point(size = 1)+\n  labs(title =  \"Cannabis Products sold by Average Price\")+\n  xlab(\"Average Price\") +\n  ylab(\"Quantity Sold\") +\n  facet_wrap(vars(house_product), scales = \"free_y\") +\n  theme(legend.title=element_blank(),axis.text.x = element_text(angle = 45, vjust = 0.5) )\n\nsold_by_price\n```\n\n::: {.cell-output-display}\n![](MichaelaBowen_challenge7_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n:::\n",
    "supporting": [
      "MichaelaBowen_challenge7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}