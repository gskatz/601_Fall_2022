{
  "hash": "c4ba03ab87e27380ab5847eb6d9bbb46",
  "result": {
    "markdown": "---\ntitle: \"Olympic Analysis\"\nauthor: \"Matthew Norberg\"\ndate: \"11/7/2022\"\nformat: \n  html: \n    toc: true\n    code-copy: true\n    code-tools: true\n    smooth-scroll: true\n    code-line-numbers: true\n    highlight-style: github\n    theme: zephyr\n    df-print: default\ncategories:\n  - hw3\n  - Olympic_Data\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gridExtra)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Read Clean Data\n\nIn the previous homework assignment, I cleaned the Olympic data set and saved the cleaned data set in a new csv file.  To avoid duplicating code, I am going to read in the cleaned data set instead of the original one. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_csv('./Data/athletes_clean.csv')\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 270,767 × 15\n      ID Name    Team  NOC   Region Sex     Age Height Weight  Year Season City \n   <dbl> <chr>   <chr> <chr> <chr>  <chr> <dbl>  <dbl>  <dbl> <dbl> <chr>  <chr>\n 1  1724 \"Arist… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 2  1724 \"Arist… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 3  1725 \"Konst… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 4  1725 \"Konst… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 5  4113 \"Anast… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 6  4116 \"Ioann… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 7  4189 \"Nikol… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 8  4431 \"Georg… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n 9  4493 \"Antel… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n10  5660 \"Georg… Gree… GRE   Greece M        24    173   71.4  1896 Summer Athi…\n# … with 270,757 more rows, and 3 more variables: Sport <chr>, Event <chr>,\n#   Medal <chr>\n```\n:::\n:::\n\n\n## Investigating Athletes\n\nLet's start by gathering some basic stats on the athletes.  I am going to separate the athletes into a male and female group because I think this will more accurately portray the information.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gather basic athletes stats\ndf %>% \n  group_by(Sex) %>%\n  summarise(Count = n(), \n            AverageAge = mean(Age), \n            SDAge = sd(Age),\n            AverageHeight = mean(Height),\n            SDHeight = sd(Height),\n            AverageWeight = mean(Weight),\n            SDWeight = sd(Weight))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 8\n  Sex    Count AverageAge SDAge AverageHeight SDHeight AverageWeight SDWeight\n  <chr>  <int>      <dbl> <dbl>         <dbl>    <dbl>         <dbl>    <dbl>\n1 F      74393       23.8  5.79          169.     8.63          61.2     10.2\n2 M     196374       26.3  6.34          178.     8.16          74.6     11.4\n```\n:::\n:::\n\n\nThe statistics above are for everyone in the data set.  The first question I have as someone who is interested in the data is if these stats are different for people who have won medals.  The next block of code generates the same stats for the athletes who have won a medal.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gather basic stats for athletes who won a medal\ndf %>%\n  filter(Medal != \"None\") %>%\n  group_by(Sex) %>%\n  summarise(Count = n(), \n            AverageAge = mean(Age), \n            SDAge = sd(Age),\n            AverageHeight = mean(Height),\n            SDHeight = sd(Height),\n            AverageWeight = mean(Weight),\n            SDWeight = sd(Weight))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 8\n  Sex   Count AverageAge SDAge AverageHeight SDHeight AverageWeight SDWeight\n  <chr> <int>      <dbl> <dbl>         <dbl>    <dbl>         <dbl>    <dbl>\n1 F     11246       24.5  5.27          171.     8.76          63.9     10.5\n2 M     28528       26.5  5.99          180.     8.83          77.2     12.2\n```\n:::\n:::\n\n\nThe tables that I created above are a good way to look at the distribution of athlete statistics.  However, they are not as good as a diagram. Let's look at density plots of the age, height, and weight variables to get a better view of the distribution.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nageDensity <- df %>%\n              ggplot() + \n              geom_density(mapping = aes(x = Age, group = Sex, fill = Sex), \n                           adjust = 2,\n                           alpha = 0.1) + \n              labs(title = \"Age Density For All Athletes\")\n\nheightDensity <- df %>%\n                 ggplot() + \n                 geom_density(mapping = aes(x = Height, group = Sex, fill = Sex), \n                              adjust = 2,\n                              alpha = 0.1) +\n                 labs(title = \"Height Density For All Athletes\")\n\nweightDensity <- df %>%\n                 ggplot() + \n                 geom_density(mapping = aes(x = Weight, group = Sex, fill = Sex), \n                              adjust = 2,\n                              alpha = 0.1) +\n                 labs(title = \"Weight Density For All Athletes\")\n\ngrid.arrange(ageDensity, heightDensity, weightDensity, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/statDistributions-1.png){width=672}\n:::\n:::\n\n\nThe density plots shown above seem to make sense based on the data set we are looking at.  We would expect the Age and Weight distribution to be skewed because we are looking at data for Olympic athletes.  I am surprised that the distribution of the Height variable appears to be symmetric.  Based on the data set, I would have thought the distribution would have been skewed as well. \n\nI am wondering if the distributions for these variables look different if we only look at the athletes that have won medals.  We can generate these visuals by filtering the data set so that it only contains athletes who have won medals and then using the same code from above to create the density plots. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedalAgeDensity <- df %>%\n                   filter(Medal != \"None\") %>%\n                   ggplot() + \n                      geom_density(mapping = aes(x = Age, group = Sex, fill = Sex), \n                      adjust = 2,\n                      alpha = 0.1) + \n                      labs(title = \"Athletes With Medals\")\n\nmedalHeightDensity <- df %>%\n                      filter(Medal != \"None\") %>%\n                      ggplot() + \n                         geom_density(mapping = aes(x = Height, group = Sex, fill = Sex), \n                         adjust = 2,\n                         alpha = 0.1) + \n                         labs(title = \"Athletes With Medals\")\n\nmedalWeightDensity <- df %>%\n                      filter(Medal != \"None\") %>%\n                      ggplot() + \n                         geom_density(mapping = aes(x = Weight, group = Sex, fill = Sex), \n                         adjust = 2,\n                         alpha = 0.1) +\n                         labs(title = \"Athletes With Medals\")\n\ngrid.arrange(ageDensity, medalAgeDensity, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/statMedalDistributions-1.png){width=672}\n:::\n\n```{.r .cell-code}\ngrid.arrange(heightDensity, medalHeightDensity, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/statMedalDistributions-2.png){width=672}\n:::\n\n```{.r .cell-code}\ngrid.arrange(weightDensity, medalWeightDensity, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/statMedalDistributions-3.png){width=672}\n:::\n:::\n\n\nI think it is interesting that the density plots do not change much when we only look at the athletes who have won medals.  Based on the plots generated in the previous code block, it appears that it would be difficult to predict whether or not an athlete would win a medal based solely on their age, height, and weight. Perhaps if I grouped the athletes by event and then compared the density plots for age, height, and weight for the athletes that won a medal versus the athletes who did not win a medal in the particular event, I would see different results.  This is something I would like to investigate for the final analysis.\n\n## Investigating Medals By Country\n\nTo start investigating how medals relates to country, let's find out how many medals of each type each country has and how many total medals each country has.  This has been done with the following chunk of R Code. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountryMedal <- df %>%\n                group_by(Region) %>%\n                count(Medal) %>%\n                pivot_wider(names_from = Medal, values_from = n) %>%\n                relocate(Bronze, .after = None) %>%\n                relocate(Silver, .after = Bronze) %>% \n                arrange(desc(Gold)) %>%\n                mutate(TotalMedals = sum(Bronze,Silver,Gold, na.rm = TRUE))\ncountryMedal\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 208 × 6\n# Groups:   Region [208]\n   Region   None Bronze Silver  Gold TotalMedals\n   <chr>   <int>  <int>  <int> <int>       <int>\n 1 USA     13216   1358   1641  2638        5637\n 2 Russia   7745   1178   1170  1599        3947\n 3 Germany 12127   1260   1195  1301        3756\n 4 UK      10188    651    739   678        2068\n 5 Italy    9078    531    531   575        1637\n 6 France  10981    666    610   501        1777\n 7 Sweden   6803    535    522   479        1536\n 8 Canada   8382    451    438   463        1352\n 9 Hungary  5472    371    332   432        1135\n10 Norway   3927    294    361   378        1033\n# … with 198 more rows\n```\n:::\n:::\n\n\nWe can visualize this information a little better by generating a bar plot to show visually how many medals each country has won.  I thought it was more interesting to look at the number of gold medals each country has won.  The bar chart is generated below.  Note that I only included the top 25 countries with the most gold medals to make the chart have a reasonable size. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Chart of number of golds per country\ncountryMedal %>%\n  head(n = 25) %>%\n  ggplot(aes(x = fct_reorder(Region, Gold), y = Gold)) + \n    geom_bar(stat = \"identity\", fill=\"#f68060\", alpha=.6, width=.4) + \n    coord_flip() + \n    theme_bw() + \n    labs(x = \"Country\", title = \"Number of Gold Medals Per Country\")\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nBased on the chart above, it seems that the amount of gold medals won by each country is extremely skewed.  Let's see if this is true with the total number of medals won by each country by making a histogram.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Medal Distribution\ncountryMedal %>%\n  filter(!is.na(TotalMedals)) %>%\n  ggplot(aes(x = TotalMedals)) + \n  geom_histogram(fill=\"#f68060\", color=\"#e9ecef\", alpha=0.9, bins = 100) + \n  labs(x = \"Total Medals\",\n       y = \"Number of Countries\",\n       title = \"Number of Countries vs Total Medals\") +\n  xlim(c(0,6000)) + \n  ylim(c(0,20))\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/totalMedalsHist-1.png){width=672}\n:::\n:::\n\n\nIt seems like the distribution of the total number of medals earned by each country is also very skewed based on the diagram below.  The large majority of countries in the dataset have less than 1000 medals, however there are a few that have so many like the United States.\n\n## Investigating Medals By Athletes\n\nInstead of looking at the countries with the most medals, let's look at the athletes who have won the most medals.  The following chunk of R code find the athletes that have won the most medals and shows the number of each type of medal earned by the athlete.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Medal count by athlete\nbestAthletes <- df %>%\n                filter(Medal != \"None\") %>%\n                group_by(Name) %>%\n                count(Medal) %>%\n                pivot_wider(names_from = Medal, values_from = n) %>%\n                mutate(TotalMedals = Bronze + Silver + Gold) %>%\n                arrange(desc(TotalMedals))\n\nbestAthletes\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 28,197 × 5\n# Groups:   Name [28,197]\n   Name                                               Gold Bronze Silver Total…¹\n   <chr>                                             <int>  <int>  <int>   <int>\n 1 \"Michael Fred Phelps, II\"                            23      2      3      28\n 2 \"Larysa Semenivna Latynina (Diriy-)\"                  9      4      5      18\n 3 \"Nikolay Yefimovich Andrianov\"                        7      3      5      15\n 4 \"Borys Anfiyanovych Shakhlin\"                         7      2      4      13\n 5 \"Edoardo Mangiarotti\"                                 6      2      5      13\n 6 \"Ole Einar Bjrndalen\"                                 8      1      4      13\n 7 \"Takashi Ono\"                                         5      4      4      13\n 8 \"Aleksey Yuryevich Nemov\"                             4      6      2      12\n 9 \"Dara Grace Torres (-Hoffman, -Minas)\"                4      4      4      12\n10 \"Jennifer Elisabeth \\\"Jenny\\\" Thompson (-Cumpeli…     8      1      3      12\n# … with 28,187 more rows, and abbreviated variable name ¹​TotalMedals\n```\n:::\n:::\n\n\nNo surprise that Michael Phelps is at the top of the list of the previous tibble.  One way to visualize the athletes and the amount of medals they have won is with a timeline graph.  For the top 10 athletes in the tibble above, I will create a graph where the x axis denotes the year and the y axis denotes the total number of medals they have won at that point in time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop5 <- bestAthletes %>% \n        select(Name) %>% \n        head(n = 10)\n\ndf %>%\n  filter(Name %in% top5$Name) %>%\n  group_by(Name, Year, Season) %>%\n  count(Medal) %>%\n  pivot_wider(names_from = Medal, values_from = n) %>%\n  mutate(TotalMedals = sum(Bronze,Silver,Gold, na.rm = TRUE)) %>%\n  group_by(Name) %>%\n  mutate(CumulativeMedals = cumsum(TotalMedals)) %>%\n  ggplot(mapping = aes(x = Year, y = CumulativeMedals, color = Name)) +\n    geom_point() +\n    geom_line() + \n    labs(x = \"Year\", y = \"Total Number of Medals Earned At Time Period X\", title = \"Athlete Medal Accumulation Over Time\")\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/top5-1.png){width=672}\n:::\n:::\n\n\n## Investigating Medals By Event\n\nOne more interesting way to look at the medals in the data set is by event.  Some events award more medals than others and I wanted to know which events awarded the most.  The bar chart below shows the top 10 events which give the most medals.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  group_by(Event) %>%\n  count(Medal) %>%\n  pivot_wider(names_from = Medal, values_from = n) %>%\n  mutate(TotalMedals = sum(Bronze,Silver,Gold, na.rm = TRUE)) %>%\n  arrange(desc(TotalMedals)) %>%\n  head(n = 10) %>%\n  ggplot(aes(x = fct_reorder(Event, TotalMedals), y = TotalMedals)) +\n    geom_bar(stat = \"identity\", fill=\"#f68060\", alpha=.6, width=.4) + \n    coord_flip() +\n    theme_bw() +\n    labs(y = \"Total Number of Medals\",\n         x = \"Event\",\n         title = \"Number of Medals by Event\")\n```\n\n::: {.cell-output-display}\n![](HW3_MatthewNorberg_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe graph generated above shows that some events award more medals than others.  Perhaps if I only look at the events that award the most medals, I will see trends in the athletes that determine who will get the medals versus who will not.  In otherwords, I think the analsis of the athletes will be more revealing when I analyze them for their specific event, instead of analyzing them all at once.\n",
    "supporting": [
      "HW3_MatthewNorberg_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}