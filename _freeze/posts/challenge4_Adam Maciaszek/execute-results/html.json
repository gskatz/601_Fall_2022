{
  "hash": "47064c5a027af144df2334c84871829e",
  "result": {
    "markdown": "---\ntitle: \"Challenge 4 Adam Macaiszek\"\nauthor: \"Adam Maciaszek\"\ndesription: \"More data wrangling: pivoting\"\ndate: \"10/08/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_4\n  - debt\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(summarytools)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\nToday's challenge is to:\n\n1)  read in a data set, and describe the data set using both words and any supporting information (e.g., tables, etc)\n2)  tidy data (as needed, including sanity checks)\n3)  identify variables that need to be mutated\n4)  mutate variables and sanity check all mutations\n\n## Read in data\n\nRead in one (or more) of the following datasets, using the correct R package and command.\n\n-   debt_in_trillions.xlsx ⭐⭐⭐⭐⭐\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset <- data.frame()\nfile_name <- \"_data/debt_in_trillions.xlsx\"\ndataset <- read_excel(file_name, sheet = 1)\n```\n:::\n\n\n### Briefly describing the data\nThis data set is of different categories of data and thier amounts each quarter from 2003 to the second quarter of 2021. We do not know the country that this is for. The categories of debt are mortgage, HE revolving, auto, credit card student loan loan and other. Each of these categories has its own colmn and the values in is the amount of debt in trillions, there is also a column for the total debt for that quarter that year.\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(head(dataset))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 8\n  `Year and Quarter` Mortgage `HE Revolving` Auto …¹ Credi…² Stude…³ Other Total\n  <chr>                 <dbl>          <dbl>   <dbl>   <dbl>   <dbl> <dbl> <dbl>\n1 03:Q1                  4.94          0.242   0.641   0.688   0.241 0.478  7.23\n2 03:Q2                  5.08          0.26    0.622   0.693   0.243 0.486  7.38\n3 03:Q3                  5.18          0.269   0.684   0.693   0.249 0.477  7.56\n4 03:Q4                  5.66          0.302   0.704   0.698   0.253 0.449  8.07\n5 04:Q1                  5.84          0.328   0.72    0.695   0.260 0.446  8.29\n6 04:Q2                  5.97          0.367   0.743   0.697   0.263 0.423  8.46\n# … with abbreviated variable names ¹​`Auto Loan`, ²​`Credit Card`,\n#   ³​`Student Loan`\n```\n:::\n:::\n\n\n## Identify variables that need to be mutated\n\nEach data point is labeled by the year and the quarter. Using that information as well as when quarters end at least the values in America the start and end date of each quarter were calculated and put into their own column of data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarter_set <- function(input) {\n    thing <- str_split(input, \":\", n = Inf, simplify = FALSE)\n    year <- paste(\"20\",thing[[1]][1], sep=\"\")\n    quarter <- thing[[1]][2]\n    if (quarter==\"Q1\") {\n        start <- paste(year, \"/1/1\", sep=\"\")\n        stop <- paste(year, \"/3/31\", sep=\"\")\n        return(c(start,stop)) }\n    else if (quarter==\"Q2\") {\n        start <- paste(year, \"/4/1\", sep=\"\")\n        stop <- paste(year, \"/6/30\", sep=\"\")\n        return(c(start,stop)) }\n    else if (quarter==\"Q3\") {\n        start <- paste(year, \"/7/1\", sep=\"\")\n        stop <- paste(year, \"/9/30\", sep=\"\")\n        return(c(start,stop)) }\n    else {\n        start <- paste(year, \"/10/1\", sep=\"\")\n        stop <- paste(year, \"/12/31\", sep=\"\")\n        return(c(start,stop)) }\n}\nStart_Date <- c()\nEnd_Date <- c()\nfor (x in dataset$\"Year and Quarter\"){\n    Start_Date <- c(Start_Date,quarter_set(x)[1])\n    End_Date <- c(End_Date,quarter_set(x)[2])\n}\ndataset$start_base <- Start_Date\ndataset$end_base <- End_Date\ndataset$Year <- format(as.Date(dataset$start_base, format=\"%Y/%m/%d\"), \"%Y\")\ndataset$Start_Date <- as.Date(dataset$start_base, format=\"%Y/%m/%d\")\ndataset$End_Date <- as.Date(dataset$end_base, format=\"%Y/%m/%d\")    \ndataset <- dataset %>% select(-start_base,-end_base,-Total,-\"Year and Quarter\")\n```\n:::\n\n## Tidy Data (as needed)\nEach of the different columns of debt need to be pivoted to one variable and Type Debt. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset <- dataset %>% \n  pivot_longer(\n    cols= Mortgage:Other, \n    names_to = \"Type_Debt\", \n    values_to = \"Amount\")\n```\n:::\n\n## Tidy Data (as needed)\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(dataset, aes(x = End_Date, y = Amount, group=Type_Debt, color=Type_Debt)) + geom_line() +ggtitle(\"Mean Income Levels From (1967-2019)\")\n```\n\n::: {.cell-output-display}\n![](challenge4_Adam-Maciaszek_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\nThe mortgage accounts for such a high percent of the debt that it makes any of the other datapoints hard to see so an additional graph excluding it is below\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(dataset, Type_Debt!=\"Mortgage\"), aes(x = End_Date, y = Amount, group=Type_Debt, color=Type_Debt)) + geom_line() +ggtitle(\"Mean Income Levels From (1967-2019)\")\n```\n\n::: {.cell-output-display}\n![](challenge4_Adam-Maciaszek_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "challenge4_Adam-Maciaszek_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}