{
  "hash": "4105f0f21ebcdc0d8f16d6e89a72561d",
  "result": {
    "markdown": "---\ntitle: \"Global Military Spending - An Analysis\"\ndescription: \"Hw_3\"\nauthor: \"Julian Castoro\"\ndate: \"2022-12-20\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\noutput: distill::distill_article\ncategories:\n  - Homework3\n  - Julian Castoro\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\n\nlibrary(ggplot2)\nlibrary(gganimate)\n\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(lubridate)\n\nlibrary(leaflet)\n\noptions(digits = 3,decimals=2)\noptions(scipen = 999)\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Introduction\n\nFor HW3 I am not outputting any of the cleaning however I am leaving it in for reference.\n\nThe intent of this homework for me was to show how playing around with the descriptive statistics is a great idea for exploring your data. The questions I originally had intended to answer with the graphs lead to new questions and at the end of this has added a new time period for my final project to investigate.\n\n\nHad I simply ommitted the outline I found in the data or changed my groupings to hide it, I would not have thought to highlight this time in history.\n\n\n## Data\n\n### Briefly describe the data\n\nBelow is a list of the available sheets in the SIPRI military spending data export. A few of the tabs are the same base information altered to reflect a specific currency or ratio. I am choosing to use the \"Current USD\" as my source of raw spending numbers as I believe it to be the easiest to understand and relate to. I will also be using \"share of GDP\" as well as \"Share of Govt. spending\" to provide context around a nations spending compared to their population they intend on defending as well as compared to overall spending. \n\n### Description of data I will use \n\"Gross domestic product (GDP) is the total monetary or market value of all the finished goods and services produced within a country’s borders in a specific time period.\" - investopedia \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsheets <- excel_sheets(\"_data/SIPRI-Milex-data-1949-2021.xlsx\")\n#sheets\n```\n:::\n\n\n### Where did this information come from?\n\nThe Military spending information I am analyzing comes from **SIPRI**, the **S**tockholm **I**nternational **P**eace **R**esearch **I**nstitute. SIPRI was established in 1966 for the purpose of \"research into conflict, armaments, arms control and disarmament\". The organization is funded by the Swedish government however it regularly works internationally with research centers around the globe. SIPRI collected this particular data set from the official reports of each of the included governments in the form of official publications such as public budgets.\n\n\n\nHere is a peek at what the raw information looks like.\n\n::: {.cell}\n\n```{.r .cell-code}\nrawrawData_ShareOfGovSpend <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[9])\n#head(rawrawData_ShareOfGovSpend)\n```\n:::\n\n\n\n### Reading in Raw information\n\nReading in raw information\n\nThe data provided by the Stockholm International Peace Research Institute(sipri) was separated into multiple tabs in one excel .xlsx file. \n\nIn order to begin working I imported the tabs I planned to utilize, skipping over some of the notes and title rows at the start of each tab.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrawData_CurrentUSD <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[6],skip=5)\nrawData_ShareOfGDP <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[7],skip=5)\nrawData_ShareOfGovSpend <- read_excel(\"_data/SIPRI-Milex-data-1949-2021.xlsx\",sheet=sheets[9],skip=7)\n\n\n\n#head(rawData_CurrentUSD)\n#head(rawData_ShareOfGDP)\n#head(rawData_ShareOfGovSpend)\n```\n:::\n\n\n\n\nNext I delete the first row of NA as well as the Notes column for each tibble.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## trying Purr here to be cleaner, we have not covered this yet so please let me know if this could be better.\n\n#tibleList <- lst(rawData_CurrentUSD, rawData_ShareOfGDP, rawData_ShareOfGovSpend)\n\n# could pur this with my func i bet\n\n## not working ^^\n\n\n\n\nrawData_CurrentUSD <- rawData_CurrentUSD[-1,]  %>%\n  select(-Notes)\n\n\nrawData_ShareOfGDP <- rawData_ShareOfGDP[-1,] %>%\n  select(-Notes)\n\n\nrawData_ShareOfGovSpend <- rawData_ShareOfGovSpend[-1,] %>%\n  select(-2:-3)\n\n\n#head(rawData_CurrentUSD)\n#head(rawData_ShareOfGDP)\n#head(rawData_ShareOfGovSpend)  \n```\n:::\n\n\n### Tidying Data\n\nBefore pivoting my data I wanted to add a column for region. I chose to do this with an algorithm as an exercise in iteration however it would have been more practical to just hard code this column.\n\n#### Before Pivoting I am adding a column for region\n\n\nThe list of countries where there are NA's for every year:\n\n::: {.cell}\n\n```{.r .cell-code}\nRegions <- rawData_CurrentUSD %>%\n  filter(is.na(`1949`))%>%\n  select(Country)\n\n#Regions\n```\n:::\n\nYou will notice that some of these are continents and sub-continents, I wanted to break these into a `Region` field. The pattern I saw and chose to exploit was the fact that the overarching category would always be followed with a more specific category such as the **Africa** followed by **North Africa** values (see earlier print outs to see raw information). \n\nI then added an empty vector into the tibble and populated it according to the Country column using the pattern described above.\n\nOnce I had left flags in the region column dictating where each region was starting I could use `fill(Region)` in order to populate the rest of the column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemptyRegionCol <- as.numeric(vector(mode = \"character\",length = length(rawData_CurrentUSD$`1949`)))## doing as numeric here as a hacky way to fill this with NA's, any better way?\n\n\n#adding col to tibble to be populated later\nmutated_CurrentUSD <- rawData_CurrentUSD %>%\n  mutate(Region =emptyRegionCol,.before=2)\n\n#mutated_CurrentUSD\n#head(mutated_CurrentUSD)\n\n\n\n# replacing the empty char in region with actual region if 2 NAs appear in a row\n  #iterates along the indices of the Country vector\nfor(i in seq_along(mutated_CurrentUSD$Country) ){\n  \n   #if 2 nas in a row then do something\n  if(is.na(mutated_CurrentUSD$`1949`[i]) && is.na(mutated_CurrentUSD$`1949`[i+1]) ){\n    mutated_CurrentUSD$Region[i+1] <- mutated_CurrentUSD$Country[i+1] #this works because when referencing an index outside of the vector R will return NA - Great to know.\n  }\n  \n  \n  #if the row is a region\n  if(is.na(mutated_CurrentUSD$`1949`[i]) ){\n     mutated_CurrentUSD$Region[i+1] <- mutated_CurrentUSD$Country[i]\n  }\n\n  \n}\n\nmutated_CurrentUSD <- mutated_CurrentUSD %>%\n  fill(Region)\n\n#mutated_CurrentUSD \n```\n:::\n\n\n\nNow that I had my proof of concept for cleaning one of the sheets, in a format I wanted, it was time to clean the other sheets as well. I could have taken the above algorithm and modified it to work for each of the other tabs individually however I took the opportunity to practice with functions and created the below function to clean any of the tabs once they were loaded in and lightly cleaned.\n\n\n# Clean and format function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## creating a function to clean the other sheets\n##Input: a partially cleaned tibble, must have been read in and had excess rows trimmed\n##output: tibble with regions correctly labeled and umbrella region categories i.e Africa above south Africa removed\n##Note: All sub categories contained the main category name in them, will use regex to create groupings in the future.\n\nCleanData <- function(inSheet){\n  emptyRegionCol <- as.numeric(vector(mode = \"character\",length = nrow(select(inSheet,2))))\n\n#adding col to tibble to be populated later\n  output <- inSheet %>%\n    mutate(Region = emptyRegionCol,.before=2)\n\n\n# replacing the empty char in region with actual region if 2 NAs appear in a row\n #iterates along the indices of the Country vector\n  for(i in seq_along(output$Country)){\n  \n    if(is.na(output[[i,3]]) && is.na(output[[(i+1),3]]))\n      output$Region[i+1] <- output$Country[i+1]\n    \n    if(is.na(output[[i,3]]))\n       output$Region[i+1] <- output$Country[i]\n  }\n  \n  output <- output %>%\n    fill(Region)\n  \n  \n  # removing header rows\n  output <- output %>%\n    filter(!is.na(output[[3]]))\n}\n```\n:::\n\n\nBelow I call the function on each of the tibbles loaded in earlier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCleaned_currentUSD <- CleanData(rawData_CurrentUSD)\nCleaned_ShareOfGovSpend <- CleanData(rawData_ShareOfGovSpend)\nCleaned_ShareOfGDP <- CleanData(rawData_ShareOfGDP)\n\n#head(Cleaned_currentUSD)\n#head(Cleaned_ShareOfGovSpend)\n#head(Cleaned_ShareOfGDP)\n```\n:::\n\n\n## Pivoting years and \nNext I pivot the years, it should be noted that both the pivoting and Converting of notation could be handled by the clean function above, i kept the steps separate so that I could show the progression of the dataframe.\n\n\nI must also handle the xxx and ... notations. From the information page of my data set I can see that the notation is described as follows:\n\nRaw Notation  | Meaning\n------------- | -------------\n...  | Data unavailable\nxxx  |  Country did not exist or was not independent during all or part of the year in question\n\n\nFor now I think I will just keep both as NA but will save this form of the information for future use.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCleaned_currentUSD <- Cleaned_currentUSD %>%\n  pivot_longer(cols=3:ncol(Cleaned_currentUSD),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n  \nCleaned_ShareOfGovSpend <- Cleaned_ShareOfGovSpend %>%\n  pivot_longer(cols=3:ncol(Cleaned_ShareOfGovSpend),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n\nCleaned_ShareOfGDP <- Cleaned_ShareOfGDP %>%\n  pivot_longer(cols=3:ncol(Cleaned_ShareOfGDP),names_to = \"Year\",values_drop_na = FALSE)%>%\n    na_if(\"...\") %>%\n      na_if(\"xxx\")\n```\n:::\n\n\n\n\n### Converting column types\nFinally I will convert the column types to their correct representation.\n\nBefore:\n\n::: {.cell}\n\n```{.r .cell-code}\n#head(Cleaned_currentUSD)\n#head(Cleaned_ShareOfGovSpend)\n#head(Cleaned_ShareOfGDP)\n\n# Year to date\n#Cleaned_currentUSD$Year<-as_date(Cleaned_currentUSD$Year, format = \"%Y\",tz=NULL)\n#Cleaned_ShareOfGovSpend$Year<-as_date(Cleaned_ShareOfGovSpend$Year, format = \"%Y\",tz=NULL)\n#Cleaned_ShareOfGDP$Year<-as_date(Cleaned_ShareOfGDP$Year, format = \"%Y\",tz=NULL)\n\n#Year to Number\nCleaned_currentUSD$Year<-as.integer(Cleaned_currentUSD$Year)\nCleaned_ShareOfGovSpend$Year<-as.integer(Cleaned_ShareOfGovSpend$Year)\nCleaned_ShareOfGDP$Year<-as.integer(Cleaned_ShareOfGDP$Year)\n\n#Cleaned_currentUSD\n\n\n# value to double\nCleaned_currentUSD$value <- as.numeric(Cleaned_currentUSD$value)\nCleaned_ShareOfGovSpend$value<- as.numeric(Cleaned_ShareOfGovSpend$value)\nCleaned_ShareOfGDP$value<- as.numeric(Cleaned_ShareOfGDP$value)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#view(Cleaned_ShareOfGovSpend)=\nCleaned_currentUSD <- Cleaned_currentUSD %>%\n  rename(MilitarySpend_currentUSD=value)\n\nCleaned_ShareOfGovSpend <- Cleaned_ShareOfGovSpend%>%\n  rename(MilitarySpend_ShareofGovSpend=value)\n\nCleaned_ShareOfGDP <- Cleaned_ShareOfGDP%>%\n  rename(MilitarySpend_ShareofGDP=value)\n\n#head(Cleaned_currentUSD)\n#head(Cleaned_ShareOfGovSpend)\n#head(Cleaned_ShareOfGDP)\n```\n:::\n\n\n## join of the different tabs\nI think we will want to do a full join as we dont want to lose any information.\n\n::: {.cell}\n\n```{.r .cell-code}\n#nrow(Cleaned_currentUSD)\n#nrow(Cleaned_ShareOfGovSpend)\n#nrow(Cleaned_ShareOfGDP)\n\nMilitarySpend<- full_join(Cleaned_currentUSD,Cleaned_ShareOfGovSpend,by=c(\"Country\",\"Year\",\"Region\"))\n\nMilitarySpend <- full_join(MilitarySpend,Cleaned_ShareOfGDP,by=c(\"Country\",\"Year\",\"Region\"))\n\n\n\n#head(MilitarySpend)\n#nrow(MilitarySpend)\n```\n:::\n\n\n\n\n\n## HW3\n### descriptive stats\nmean median and std for each of the tabs\nCharts for the stats\n\n\n\nFirst I wanted to get an idea of what my data looks like for each of the countries individually. In order to see this I grouped on country name and the types of data we have.\n\nIn order to get that done I need to pivot my data again.\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData <-MilitarySpend %>%\n  pivot_longer(c(MilitarySpend_currentUSD,MilitarySpend_ShareofGovSpend,MilitarySpend_ShareofGDP),names_to = \"viewOfSpend\",values_to = \"Spend\")\nhead(combinedData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  Country Region        Year viewOfSpend                   Spend\n  <chr>   <chr>        <int> <chr>                         <dbl>\n1 Algeria North Africa  1949 MilitarySpend_currentUSD         NA\n2 Algeria North Africa  1949 MilitarySpend_ShareofGovSpend    NA\n3 Algeria North Africa  1949 MilitarySpend_ShareofGDP         NA\n4 Algeria North Africa  1950 MilitarySpend_currentUSD         NA\n5 Algeria North Africa  1950 MilitarySpend_ShareofGovSpend    NA\n6 Algeria North Africa  1950 MilitarySpend_ShareofGDP         NA\n```\n:::\n\n```{.r .cell-code}\n#view(combinedData)\nna.omit(combinedData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20,270 × 5\n   Country Region        Year viewOfSpend                 Spend\n   <chr>   <chr>        <int> <chr>                       <dbl>\n 1 Algeria North Africa  1963 MilitarySpend_currentUSD  66.4   \n 2 Algeria North Africa  1963 MilitarySpend_ShareofGDP   0.0251\n 3 Algeria North Africa  1964 MilitarySpend_currentUSD  99.9   \n 4 Algeria North Africa  1964 MilitarySpend_ShareofGDP   0.0350\n 5 Algeria North Africa  1965 MilitarySpend_currentUSD 106.    \n 6 Algeria North Africa  1965 MilitarySpend_ShareofGDP   0.0342\n 7 Algeria North Africa  1966 MilitarySpend_currentUSD 105.    \n 8 Algeria North Africa  1966 MilitarySpend_ShareofGDP   0.0351\n 9 Algeria North Africa  1967 MilitarySpend_currentUSD  99.2   \n10 Algeria North Africa  1967 MilitarySpend_ShareofGDP   0.0302\n# … with 20,260 more rows\n```\n:::\n:::\n\n\nBelow is a graph depicting the completeness of the information available to us.\n\nTotal number of countries analyzed:\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  distinct(Country)%>%\n  count()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n      n\n  <int>\n1   173\n```\n:::\n:::\n\nNumber of countries by region:\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  group_by(Region)%>%\n  summarise(numberCountries = n_distinct(Country))%>%\n  arrange(desc(numberCountries))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 2\n   Region                            numberCountries\n   <chr>                                       <int>\n 1 sub-Saharan Africa                             47\n 2 Central Europe                                 20\n 3 Western Europe                                 20\n 4 Middle East                                    16\n 5 Central America and the Caribbean              13\n 6 South America                                  11\n 7 South East Asia                                11\n 8 Eastern Europe                                  8\n 9 East Asia                                       6\n10 South Asia                                      6\n11 Central Asia                                    5\n12 North Africa                                    4\n13 Oceania                                         4\n14 North America                                   2\n```\n:::\n:::\n\nDue to the number of Regions I may need to focus on some in particular...\n\nby year, how many countries had data available\n\n::: {.cell}\n\n:::\n\n\n\nStatistics by region\n\n#MilitarySpend_currentUSD\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_USD<-combinedData%>%\n  group_by(Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE),\n            min = min(Spend, na.rm=TRUE),\n            max = max(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))%>%\n  filter(viewOfSpend==\"MilitarySpend_currentUSD\")\n\nbyRegionStats_USD\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 6\n# Groups:   Region [14]\n   Region                            viewOfSpend       mean    std    min    max\n   <chr>                             <chr>            <dbl>  <dbl>  <dbl>  <dbl>\n 1 North America                     MilitarySpend_… 1.49e5 2.23e5 426.   8.01e5\n 2 East Asia                         MilitarySpend_… 2.04e4 4.21e4   0    2.93e5\n 3 Eastern Europe                    MilitarySpend_… 1.09e4 3.52e4   0    2.46e5\n 4 Western Europe                    MilitarySpend_… 7.14e3 1.28e4   0    7.34e4\n 5 Middle East                       MilitarySpend_… 4.91e3 9.59e3   0    8.72e4\n 6 South Asia                        MilitarySpend_… 4.46e3 1.17e4   2.48 7.66e4\n 7 Oceania                           MilitarySpend_… 2.83e3 6.29e3   0    3.18e4\n 8 South America                     MilitarySpend_… 2.02e3 4.57e3   0    3.69e4\n 9 South East Asia                   MilitarySpend_… 1.94e3 3.16e3   0    3.30e4\n10 North Africa                      MilitarySpend_… 1.36e3 2.21e3   3.71 1.04e4\n11 Central Europe                    MilitarySpend_… 1.14e3 2.20e3   0    1.74e4\n12 Central Asia                      MilitarySpend_… 3.36e2 5.92e2   0    2.55e3\n13 Central America and the Caribbean MilitarySpend_… 2.86e2 9.54e2   0    8.68e3\n14 sub-Saharan Africa                MilitarySpend_… 2.58e2 6.35e2   0    6.85e3\n```\n:::\n:::\n\n\n#MilitarySpend_ShareOfGDP\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GDP<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE),\n            min = min(Spend, na.rm=TRUE),\n            max = max(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGDP\")\n\nbyRegionStats_GDP\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,022 × 7\n# Groups:   Region, viewOfSpend [14]\n   Region      viewOfSpend               Year  mean    std    min   max\n   <chr>       <chr>                    <int> <dbl>  <dbl>  <dbl> <dbl>\n 1 Middle East MilitarySpend_ShareofGDP  1991 0.167 0.305  0.0217 1.17 \n 2 Middle East MilitarySpend_ShareofGDP  1975 0.147 0.0893 0.0153 0.305\n 3 Middle East MilitarySpend_ShareofGDP  1959 0.146 0.112  0.0671 0.225\n 4 Middle East MilitarySpend_ShareofGDP  1976 0.139 0.0800 0.0175 0.292\n 5 Middle East MilitarySpend_ShareofGDP  1974 0.131 0.0765 0.0319 0.277\n 6 Middle East MilitarySpend_ShareofGDP  1982 0.117 0.0539 0.0430 0.193\n 7 Middle East MilitarySpend_ShareofGDP  1973 0.117 0.0828 0.0186 0.279\n 8 Middle East MilitarySpend_ShareofGDP  1978 0.115 0.0619 0.0419 0.229\n 9 Middle East MilitarySpend_ShareofGDP  1985 0.113 0.0661 0.0353 0.248\n10 Middle East MilitarySpend_ShareofGDP  1977 0.112 0.0632 0.0208 0.231\n# … with 1,012 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GDP\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,022 × 7\n# Groups:   Region, viewOfSpend [14]\n   Region      viewOfSpend               Year  mean    std    min   max\n   <chr>       <chr>                    <int> <dbl>  <dbl>  <dbl> <dbl>\n 1 Middle East MilitarySpend_ShareofGDP  1991 0.167 0.305  0.0217 1.17 \n 2 Middle East MilitarySpend_ShareofGDP  1975 0.147 0.0893 0.0153 0.305\n 3 Middle East MilitarySpend_ShareofGDP  1959 0.146 0.112  0.0671 0.225\n 4 Middle East MilitarySpend_ShareofGDP  1976 0.139 0.0800 0.0175 0.292\n 5 Middle East MilitarySpend_ShareofGDP  1974 0.131 0.0765 0.0319 0.277\n 6 Middle East MilitarySpend_ShareofGDP  1982 0.117 0.0539 0.0430 0.193\n 7 Middle East MilitarySpend_ShareofGDP  1973 0.117 0.0828 0.0186 0.279\n 8 Middle East MilitarySpend_ShareofGDP  1978 0.115 0.0619 0.0419 0.229\n 9 Middle East MilitarySpend_ShareofGDP  1985 0.113 0.0661 0.0353 0.248\n10 Middle East MilitarySpend_ShareofGDP  1977 0.112 0.0632 0.0208 0.231\n# … with 1,012 more rows\n```\n:::\n\n```{.r .cell-code}\nbyRegionStats_GDP<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGDP\")\n\n\nbyRegionStats_GDP$Region<-as.factor(byRegionStats_GDP$Region)\n\nviolin_gdp<- na.omit(byRegionStats_GDP)%>%\n  ggplot(aes(x=Region,y=Spend))+\n  geom_violin()\n\nviolin_gdp\n```\n\n::: {.cell-output-display}\n![](Final-Project-_HW3_-JulianCastoro_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# removing NAs here because I cant plot them, I dont want to replace them with other values because it is still of interest when countries do not display thier data.\n```\n:::\n\nSomething crazy going on with the middle east spend...\n\nInvestigation:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GDP%>%\n  filter(Region==\"Middle East\")%>%\n  arrange(desc(Spend))%>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n# Groups:   Region, viewOfSpend, Year [6]\n  Country Region       Year viewOfSpend              Spend\n  <chr>   <fct>       <int> <chr>                    <dbl>\n1 Kuwait  Middle East  1991 MilitarySpend_ShareofGDP 1.17 \n2 Kuwait  Middle East  1990 MilitarySpend_ShareofGDP 0.485\n3 Kuwait  Middle East  1992 MilitarySpend_ShareofGDP 0.318\n4 Israel  Middle East  1975 MilitarySpend_ShareofGDP 0.305\n5 Israel  Middle East  1976 MilitarySpend_ShareofGDP 0.292\n6 Israel  Middle East  1973 MilitarySpend_ShareofGDP 0.279\n```\n:::\n:::\n\nI initially thought this was a typo since there were two 1s in a row and it was such an insanely high spend. A share of GDP of 1.173 means Kuwait spent 117.3% of their GDP in that year. Upon further investigation, this is actually true and it was driven by the Persian Gulf War(aka Gulf War). The Gulf War was a conflict triggered by Iraqs invasion of Kuwait in 1990. This invasion was the first major international crisis since the Cold War and will certainly be a topic I add to the final analysis.\n\nhttps://www.britannica.com/event/Persian-Gulf-War\n\n\nLoosely I will plot Iraq, US and Kuwait spend from 1985-1995 to explore this time period.\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  filter(Year >= 1985 & Year<= 1995)%>%\n  filter(Country %in% c(\"United States of America\",\"Iraq\",\"Kuwait\"))%>%\n    ggplot(mapping=aes(y = Spend, x = Year))+  \n    geom_point(aes(color = Country, alpha=0.9),na.rm = FALSE)+\n    facet_wrap(vars(`viewOfSpend`),scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](Final-Project-_HW3_-JulianCastoro_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\nA new discovery! Iraq chose not to report their spending during the Gulf war.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombinedData%>%\n  filter(Country %in% c(\"Iraq\"))%>%\n  filter(Year>1960&is.na(Spend))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 87 × 5\n   Country Region       Year viewOfSpend                   Spend\n   <chr>   <chr>       <int> <chr>                         <dbl>\n 1 Iraq    Middle East  1961 MilitarySpend_ShareofGovSpend    NA\n 2 Iraq    Middle East  1962 MilitarySpend_ShareofGovSpend    NA\n 3 Iraq    Middle East  1963 MilitarySpend_ShareofGovSpend    NA\n 4 Iraq    Middle East  1964 MilitarySpend_ShareofGovSpend    NA\n 5 Iraq    Middle East  1965 MilitarySpend_ShareofGovSpend    NA\n 6 Iraq    Middle East  1966 MilitarySpend_ShareofGovSpend    NA\n 7 Iraq    Middle East  1967 MilitarySpend_ShareofGovSpend    NA\n 8 Iraq    Middle East  1968 MilitarySpend_ShareofGovSpend    NA\n 9 Iraq    Middle East  1969 MilitarySpend_ShareofGovSpend    NA\n10 Iraq    Middle East  1970 MilitarySpend_ShareofGovSpend    NA\n# … with 77 more rows\n```\n:::\n\n```{.r .cell-code}\nstartOfNoData<- 1982\nendofNoData<- 2003\n\niraqMissingDataPLOT<-combinedData%>%\n  filter(Country %in% c(\"Iraq\"))%>%\n    ggplot(mapping=aes( x = Spend,y = Year))+\n    geom_point()+\n    facet_wrap(vars(`viewOfSpend`),scales = \"free_x\")+\n    scale_y_continuous(labels=seq(1949,2020,5),breaks =seq(1949,2020,5))\n\niraqMissingDataPLOT+\ngeom_hline(yintercept = 1982,color=\"red\")+\ngeom_hline(yintercept = 2003,color=\"red\")+\nannotate(\"text\",x=0,y=1982,label=\"1982\",hjust=-0.1,vjust=-0.1,color=\"red\")+\nannotate(\"text\",x=0,y=2003,label=\"2003\",hjust=-0.1,vjust=1.1,color=\"red\")\n```\n\n::: {.cell-output-display}\n![](Final-Project-_HW3_-JulianCastoro_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\nBelow I continue to explore the dataset. This might be too much for HW3 however I was doing it anyway for the final so I chose to include it.\n\n\n#MilitarySpend_ShareofGovSpend\n\nNow to explore the statistics within the Share of Gov Spend tab.\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_GovSpend<-combinedData%>%\n  group_by(Region,viewOfSpend)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE,sigfig=1),\n            std = sd(Spend, na.rm=TRUE),\n            min = min(Spend, na.rm=TRUE),\n            max = max(Spend, na.rm=TRUE))%>%\n  arrange(desc(mean))%>%\n  filter(viewOfSpend==\"MilitarySpend_ShareofGovSpend\")\n\nbyRegionStats_GovSpend\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 6\n# Groups:   Region [14]\n   Region                            viewOfSpend      mean    std     min    max\n   <chr>                             <chr>           <dbl>  <dbl>   <dbl>  <dbl>\n 1 Middle East                       MilitarySpend… 0.161  0.0757 1.83e-2 0.575 \n 2 South Asia                        MilitarySpend… 0.122  0.0511 3.65e-2 0.274 \n 3 Eastern Europe                    MilitarySpend… 0.115  0.0887 7.71e-3 0.350 \n 4 sub-Saharan Africa                MilitarySpend… 0.103  0.260  3.90e-3 5.82  \n 5 South East Asia                   MilitarySpend… 0.0984 0.0749 7.83e-3 0.392 \n 6 North Africa                      MilitarySpend… 0.0973 0.0369 2.81e-2 0.178 \n 7 East Asia                         MilitarySpend… 0.0837 0.0503 1.73e-2 0.225 \n 8 South America                     MilitarySpend… 0.0728 0.0392 1.73e-2 0.348 \n 9 North America                     MilitarySpend… 0.0600 0.0386 2.51e-2 0.124 \n10 Central Asia                      MilitarySpend… 0.0518 0.0269 1.36e-2 0.158 \n11 Oceania                           MilitarySpend… 0.0441 0.0155 1.54e-2 0.0879\n12 Central Europe                    MilitarySpend… 0.0439 0.0283 6.72e-4 0.290 \n13 Central America and the Caribbean MilitarySpend… 0.0354 0.0218 2.20e-3 0.214 \n14 Western Europe                    MilitarySpend… 0.0348 0.0189 8.58e-3 0.164 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(forcats)\n\nstatsViz2<- byRegionStats%>%\n  mutate(test = fct_reorder(Region,desc(mean)))%>%\n  ggplot(mapping=aes(y = test, x = mean))+  \n  geom_point(aes(color = Region, alpha=0.9, size=max)) +\n  guides(alpha=\"none\",color=\"none\") +\n  labs(title = \"Certain Regions on average spend more than others\" ,caption = \"Data from SPIRI Military Expediture Database\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in mutate(., test = fct_reorder(Region, desc(mean))): object 'byRegionStats' not found\n```\n:::\n\n```{.r .cell-code}\nstatsViz2\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'statsViz2' not found\n```\n:::\n:::\n\n\nFrom this we can see the top 6 spenders reside in a cluster of there own when you look at their mean and max spend.\n\nTop 6\n\n::: {.cell}\n\n```{.r .cell-code}\ntop6_mean <- byRegionStats %>%\n  head()%>%\n  pull(Region)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in head(.): object 'byRegionStats' not found\n```\n:::\n\n```{.r .cell-code}\ntop6_mean\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'top6_mean' not found\n```\n:::\n:::\n\n\n\n## Faceted by Region, show mean spend of each country\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_year<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE))%>%\n  filter(viewOfSpend == 'MilitarySpend_currentUSD')%>%\n  arrange(desc(mean))\n\nbyRegionStats_year\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,022 × 4\n# Groups:   Region, viewOfSpend [14]\n   Region        viewOfSpend               Year    mean\n   <chr>         <chr>                    <int>   <dbl>\n 1 North America MilitarySpend_currentUSD  2021 413561.\n 2 North America MilitarySpend_currentUSD  2020 400839.\n 3 North America MilitarySpend_currentUSD  2011 386841.\n 4 North America MilitarySpend_currentUSD  2010 378660.\n 5 North America MilitarySpend_currentUSD  2019 378369.\n 6 North America MilitarySpend_currentUSD  2012 372829.\n 7 North America MilitarySpend_currentUSD  2009 362427.\n 8 North America MilitarySpend_currentUSD  2018 352610.\n 9 North America MilitarySpend_currentUSD  2013 348872.\n10 North America MilitarySpend_currentUSD  2008 338049.\n# … with 1,012 more rows\n```\n:::\n\n```{.r .cell-code}\nbyRegionplot<- byRegionStats_year%>%\n  ggplot(mapping=aes(x = Year, y = mean))+  \n  geom_point(aes(color = Region, alpha=0.9,)) +\n  theme_light() +\n  guides(alpha=\"none\") +\n  labs(title = \"East asia and NA dominate raw spend\" ,caption = \"Data from SPIRI Military Expediture Database\")\n  \n\nbyRegionplot\n```\n\n::: {.cell-output-display}\n![](Final-Project-_HW3_-JulianCastoro_files/figure-html/123-1.png){width=672}\n:::\n:::\n\n\n\n## To be a little less noisy, showing the top 6 spenders over time\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_year_top6<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  summarize(mean = mean(Spend, na.rm=TRUE))%>%\n  filter(viewOfSpend == 'MilitarySpend_currentUSD')%>%\n  filter(Region == top6_mean)%>%\n  arrange(desc(mean))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Region == top6_mean`.\nℹ The error occurred in group 1: Region = \"Central America and the Caribbean\",\n  viewOfSpend = \"MilitarySpend_currentUSD\".\nCaused by error in `mask$eval_all_filter()`:\n! object 'top6_mean' not found\n```\n:::\n\n```{.r .cell-code}\nbyRegionplot_top6<- byRegionStats_year_top6%>%\n  ggplot(mapping=aes(x = Year, y = mean))+  \n  geom_point(aes(color = Region, alpha=0.9,)) +\n  facet_wrap(vars(`Region`),scales = \"free_y\") +\n  labs(title = \"Raw Mean Spend in USD for top 6 Spenders\" ,caption = \"Data from SPIRI Military Expediture Database\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(., mapping = aes(x = Year, y = mean)): object 'byRegionStats_year_top6' not found\n```\n:::\n\n```{.r .cell-code}\nbyRegionplot_top6\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'byRegionplot_top6' not found\n```\n:::\n:::\n\n\nFrom here I choose to investigate Eastern Europe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbyRegionStats_year_EasternEurope<-combinedData%>%\n  group_by(Region,viewOfSpend,Year)%>%\n  filter(viewOfSpend == 'MilitarySpend_currentUSD')%>%\n  filter(Region == 'Eastern Europe')\n\nEasternEuropePlot<- byRegionStats_year_EasternEurope%>%\n  ggplot(mapping=aes(x = Year, y = Spend))+  \n  geom_point(aes(color = Country, alpha=0.9)) +\n  facet_wrap(vars(`Country`)) +\n  labs(title = \"Raw Mean Spend in Eastern Europe\" ,caption = \"Data from SPIRI Military Expediture Database\")\n  \nEasternEuropePlot\n```\n\n::: {.cell-output-display}\n![](Final-Project-_HW3_-JulianCastoro_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\nI left the scaling fixed so that you could see how high USSR spending was and then they become Russia and spend slowley increases but not to the levels of the USSR.\n\nWe see here that USSR spending looks to be about late 1990s, following some research I found...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstartOfNoData<- 1985\nendofNoData<- 1995\n\nUSSRSpendPlot<-combinedData%>%\n  filter(Country %in% c(\"USSR\",\"Russia\"))%>%\n  filter(viewOfSpend == 'MilitarySpend_currentUSD')%>%\n    ggplot(mapping=aes( x = Year,y = Spend,color = `Country`))+\n    geom_point()\n\n\nUSSRSpendPlot+\ngeom_vline(xintercept = 1987,color=\"red\")+\nannotate(\"text\",x=1987,y=0,label=\"1987\",hjust=1,vjust=-0,color=\"red\")+\n  \ngeom_vline(xintercept = 1990,color=\"red\")+\nannotate(\"text\",x=1990,y=0,label=\"1990\",hjust=-0,vjust=-0,color=\"red\")+\n\ngeom_vline(xintercept = 1945,color=\"black\")+\nannotate(\"text\",x=1945,y=0,label=\"Start of Cold War, Defeat of Germany and Japan\",hjust=-0,vjust=-0,color=\"black\",angle='90')+\n  \ngeom_vline(xintercept = 1985,color=\"black\")+\nannotate(\"text\",x=1985,y=0,label=\"Mikhail Gorbachev becomes leader of the USSR\",hjust=-0.1,vjust=-0,color=\"black\",angle='90')+\n  \ngeom_vline(xintercept = 1991,color=\"black\")+\nannotate(\"text\",x=1991,y=0,label=\"1991 End of Cold War, USSR disbanded\",hjust=-0.1,vjust=1,color=\"black\",angle='90')\n```\n\n::: {.cell-output-display}\n![](Final-Project-_HW3_-JulianCastoro_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\nFrom this view of the information it leads one to believe the USSR spending was very high during the cold war, I am unsure why we were given access to their spending towards the end of the cold war, it could have been a show of good faith, more research to come. Once the war was declared over, Russian spending fell to 0 in the following year and slowly started creeping back up.\n\nAnother area of research i get from this would be what happened in 2003- 2004 to spike the trend in Russian spending.\n\n\n## HW Questions\n\n### what questions are left unanswered?\nRussian spending during 2003-2004\n\nThe rest of my outlined possible questions from HW2 will still be answered, their answer was just not obvious from the summary statistics.\n\n\n### what may be unclear?\nIn order to improve some of these charts I could include some information about global spending at the time or perhaps augment the information to display it as a portion of global military spend? \n  - If i showed percent of global(or engaged parties) military spend it would be interesting to show if just spending more would win the wars.\n\n\n### How could I improve these vizualizations\n\nI could change the view of some of these visualizations so that they are more appealing. I liked the use of the violin plot for the Gulf War analysis and will use more variety in graphs for the final.\n\n## Conclusion\n> “Every gun that is made, every warship launched, every rocket fired signifies in the final sense, a theft from those who hunger and are not fed, those who are cold and are not clothed. > > This world in arms is not spending money alone. It is spending the sweat of its laborers, the genius of its scientists, the hopes of its children. This is not a way of life at all in any > true sense. Under the clouds of war, it is humanity hanging on a cross of iron.”\n\nDwight D. Eisenhower\n\n\n\nCitations:\nhttps://www.goodreads.com/quotes/tag/military-budget#:~:text=%E2%80%9CEvery%20gun%20that%20is%20made,is%20not%20spending%20money%20alone.\n\nhttps://www.sipri.org/about\n\nR Core Team (2017). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.\n\nWickham, H., & Grolemund, G. (2016). R for data science: Visualize, model, transform, tidy, and import data. OReilly Media.\n\nhttps://www.investopedia.com/terms/g/gdp.asp\n\n\nAppendix:\nFull descriptions as provided by SIPRI:\n\n1. Introduction\n2. Estimates of world, regional and sub-regional totals in constant (2019) US$ (billions).\n3. Data for military expenditure by country in current price local currency, presented according to each country's financial year.\n4. Data for military expenditure by country in current price local currency, presented according to calendar year.\n5. Data for military expenditure by country in constant price (2019) US$ (millions), presented according to calendar year, and in current US$m. for 2020.\n6. Data for military expenditure by country in current US$ (millions), presented according to calendar year.\n7. Data for military expenditure by country as a share of GDP, presented according to calendar year.\n8. Data for military expenditure per capita, in current US$, presented according to calender year. (1988-2020 only)\n9. Data for military expenditure as a percentage of general government expenditure. (1988-2020 only)\n\n\n\n\n",
    "supporting": [
      "Final-Project-_HW3_-JulianCastoro_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}